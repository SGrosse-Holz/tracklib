
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>tracklib.analysis &#8212; tracklib 0.1 documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="tracklib.analysis.bild" href="tracklib.analysis.bild.html" />
    <link rel="prev" title="tracklib" href="tracklib.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tracklib.analysis.bild.html" title="tracklib.analysis.bild"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tracklib.html" title="tracklib"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">tracklib 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="tracklib.html" accesskey="U">tracklib</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tracklib-analysis">
<h1>tracklib.analysis<a class="headerlink" href="#tracklib-analysis" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#tracklib-analysis-msdfit-old" id="id1">tracklib.analysis..msdfit_old</a></p></li>
<li><p><a class="reference internal" href="#module-tracklib.analysis.chi2" id="id2">tracklib.analysis.chi2</a></p></li>
<li><p><a class="reference internal" href="#module-tracklib.analysis.kld" id="id3">tracklib.analysis.kld</a></p></li>
<li><p><a class="reference internal" href="#module-tracklib.analysis.p2" id="id4">tracklib.analysis.p2</a></p></li>
<li><p><a class="reference internal" href="#module-tracklib.analysis.plots" id="id5">tracklib.analysis.plots</a></p></li>
<li><p><a class="reference internal" href="#module-tracklib.analysis.vacf" id="id6">tracklib.analysis.vacf</a></p></li>
</ul>
</div>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="tracklib.analysis.bild.html">tracklib.analysis.bild</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tracklib.analysis.bild.html#module-tracklib.analysis.bild.bild">tracklib.analysis.bild.bild</a></li>
<li class="toctree-l2"><a class="reference internal" href="tracklib.analysis.bild.html#module-tracklib.analysis.bild.kebys">tracklib.analysis.bild.kebys</a></li>
<li class="toctree-l2"><a class="reference internal" href="tracklib.analysis.bild.html#module-tracklib.analysis.bild.mcmc">tracklib.analysis.bild.mcmc</a></li>
<li class="toctree-l2"><a class="reference internal" href="tracklib.analysis.bild.html#module-tracklib.analysis.bild.models">tracklib.analysis.bild.models</a></li>
<li class="toctree-l2"><a class="reference internal" href="tracklib.analysis.bild.html#module-tracklib.analysis.bild.neda">tracklib.analysis.bild.neda</a></li>
<li class="toctree-l2"><a class="reference internal" href="tracklib.analysis.bild.html#module-tracklib.analysis.bild.plot">tracklib.analysis.bild.plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="tracklib.analysis.bild.html#tracklib-analysis-bild-postproc">tracklib.analysis.bild.postproc</a></li>
<li class="toctree-l2"><a class="reference internal" href="tracklib.analysis.bild.html#module-tracklib.analysis.bild.priors">tracklib.analysis.bild.priors</a></li>
<li class="toctree-l2"><a class="reference internal" href="tracklib.analysis.bild.html#module-tracklib.analysis.bild.util">tracklib.analysis.bild.util</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tracklib.analysis.msdfit.html">tracklib.analysis.msdfit</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tracklib.analysis.msdfit.html#module-tracklib.analysis.msdfit.core">tracklib.analysis.msdfit.core</a></li>
<li class="toctree-l2"><a class="reference internal" href="tracklib.analysis.msdfit.html#module-tracklib.analysis.msdfit.lib">tracklib.analysis.msdfit.lib</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tracklib.analysis.neda.html">tracklib.analysis.neda</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tracklib.analysis.neda.html#module-tracklib.analysis.neda.mcmc">tracklib.analysis.neda.mcmc</a></li>
<li class="toctree-l2"><a class="reference internal" href="tracklib.analysis.neda.html#module-tracklib.analysis.neda.models">tracklib.analysis.neda.models</a></li>
<li class="toctree-l2"><a class="reference internal" href="tracklib.analysis.neda.html#module-tracklib.analysis.neda.neda">tracklib.analysis.neda.neda</a></li>
<li class="toctree-l2"><a class="reference internal" href="tracklib.analysis.neda.html#module-tracklib.analysis.neda.plot">tracklib.analysis.neda.plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="tracklib.analysis.neda.html#module-tracklib.analysis.neda.postproc">tracklib.analysis.neda.postproc</a></li>
<li class="toctree-l2"><a class="reference internal" href="tracklib.analysis.neda.html#module-tracklib.analysis.neda.priors">tracklib.analysis.neda.priors</a></li>
<li class="toctree-l2"><a class="reference internal" href="tracklib.analysis.neda.html#module-tracklib.analysis.neda.util">tracklib.analysis.neda.util</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="tracklib-analysis-msdfit-old">
<h2><a class="toc-backref" href="#id1">tracklib.analysis..msdfit_old</a><a class="headerlink" href="#tracklib-analysis-msdfit-old" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-tracklib.analysis.chi2">
<span id="tracklib-analysis-chi2"></span><h2><a class="toc-backref" href="#id2">tracklib.analysis.chi2</a><a class="headerlink" href="#module-tracklib.analysis.chi2" title="Permalink to this headline">¶</a></h2>
<p>This module implements an analysis method to check stationarity.</p>
<p>Still under construction.</p>
<p>The basic idea is to test the null hypothesis “the trajectories are generated
from a process with stationary Gaussian increments”. Under this hypothesis, we know that snippets of the displacement trajectory should follow a multivariate Gaussian, whose covariance matrix we can calculate from the MSD. We can thus calculate a <span class="math notranslate nohighlight">\(\chi^2\)</span> statistic for each of these snippets, and check that they follow the expected <span class="math notranslate nohighlight">\(\chi^2\)</span> distribution.</p>
<dl class="function">
<dt id="tracklib.analysis.chi2.chi2vsMSD">
<code class="sig-prename descclassname">tracklib.analysis.chi2.</code><code class="sig-name descname">chi2vsMSD</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">n=10</em>, <em class="sig-param">msd=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.chi2.chi2vsMSD" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate snippet-wise chi2 scores assuming the given MSD.</p>
<p>The actual scores will be written to <code class="docutils literal notranslate"><span class="pre">traj.meta['chi2scores']</span></code> for each <code class="xref any docutils literal notranslate"><span class="pre">traj</span></code>
in <code class="xref any docutils literal notranslate"><span class="pre">dataset</span></code>. This function then returns just the number of degrees of
freedom that the reference chi2 distribution should have.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<a class="reference internal" href="tracklib.html#tracklib.taggedset.TaggedSet" title="tracklib.taggedset.TaggedSet"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TaggedSet</span></code></a> of <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>) – the trajectories to use</p></li>
<li><p><strong>n</strong> (<em>int</em>) – the window size / length of the snippets to look at</p></li>
<li><p><strong>msd</strong> (<em>(</em><em>T</em><em>,</em><em>) </em><em>array-like</em>) – the MSD to use for defining the reference Gaussian process. If omitted,
this will be the empirical <a class="reference internal" href="#tracklib.analysis.p2.MSD" title="tracklib.analysis.p2.MSD"><code class="xref any py py-func docutils literal notranslate"><span class="pre">MSD</span></code></a> of the data, as given by
<code class="docutils literal notranslate"><span class="pre">MSD(dataset)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>dof</strong> (<em>int</em>) – number of degrees of freedom for reference distribution.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.chi2.summary_plot" title="tracklib.analysis.chi2.summary_plot"><code class="xref py py-func docutils literal notranslate"><span class="pre">summary_plot()</span></code></a>, <code class="xref py py-func docutils literal notranslate"><span class="pre">tracklib.analysis.msd.MSD()</span></code></p>
</div>
</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.chi2.summary_plot">
<code class="sig-prename descclassname">tracklib.analysis.chi2.</code><code class="sig-name descname">summary_plot</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">dof=None</em>, <em class="sig-param">p=0.05</em>, <em class="sig-param">ax=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.chi2.summary_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce a summary plot of chi2 scores.</p>
<p>Histogram the chi-square scores calculated with <a class="reference internal" href="#tracklib.analysis.chi2.chi2vsMSD" title="tracklib.analysis.chi2.chi2vsMSD"><code class="xref any py py-func docutils literal notranslate"><span class="pre">chi2vsMSD</span></code></a>. This assumes
that each trajectory has a metadata field <code class="xref any docutils literal notranslate"><span class="pre">'chi2scores'</span></code>. Optionally also
plots significance thresholds and/or the expected chi2 distribution.</p>
<p>Any keyword arguments not listed below will be forwarded to <code class="xref any docutils literal notranslate"><span class="pre">plt.hist</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<a class="reference internal" href="tracklib.html#tracklib.taggedset.TaggedSet" title="tracklib.taggedset.TaggedSet"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TaggedSet</span></code></a> of <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>) – the data to use</p></li>
<li><p><strong>dof</strong> (<em>int</em>) – degrees of freedom for the reference chi2 distribution. If omitted, no
reference will be shown.</p></li>
<li><p><strong>p</strong> (<em>float in</em><em> (</em><em>0</em><em>, </em><em>1</em><em>)</em>) – significance level at which to draw cutoffs. Set to <code class="docutils literal notranslate"><span class="pre">None</span></code> to prevent
plotting of significance cutoffs.</p></li>
<li><p><strong>ax</strong> (<em>handle</em>) – the axes handle into which to plot. Will be set to plt.gca() if
omitted.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.chi2.chi2vsMSD" title="tracklib.analysis.chi2.chi2vsMSD"><code class="xref py py-func docutils literal notranslate"><span class="pre">chi2vsMSD()</span></code></a></p>
</div>
</dd></dl>

</div>
<div class="section" id="module-tracklib.analysis.kld">
<span id="tracklib-analysis-kld"></span><h2><a class="toc-backref" href="#id3">tracklib.analysis.kld</a><a class="headerlink" href="#module-tracklib.analysis.kld" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="tracklib.analysis.kld.perezcruz">
<code class="sig-prename descclassname">tracklib.analysis.kld.</code><code class="sig-name descname">perezcruz</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">n=10</em>, <em class="sig-param">k=20</em>, <em class="sig-param">dt=1</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.kld.perezcruz" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the KLD estimator presented by (Perez-Cruz, 2008).</p>
<p>We reduce the bias of the estimator by randomly choosing half the snippets
for estimation of the densities and then sample at the other half.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<a class="reference internal" href="tracklib.html#tracklib.taggedset.TaggedSet" title="tracklib.taggedset.TaggedSet"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TaggedSet</span></code></a> of <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>) – the data to run the KLD estimation on. Note that the trajectories
should have the <code class="docutils literal notranslate"><span class="pre">meta['parity']</span></code> field set (to either <code class="docutils literal notranslate"><span class="pre">'even'</span></code> or
<code class="docutils literal notranslate"><span class="pre">'odd'</span></code>)</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) – snippet length ( = window size)</p></li>
<li><p><strong>k</strong> (<em>int</em><em>, </em><em>optional</em>) – order of nearest neighbor for the estimator</p></li>
<li><p><strong>dt</strong> (<em>int</em><em>, </em><em>optional</em>) – number of frames between two data points in a snippet.</p></li>
<li><p><strong>parity</strong> (<em>{'even'</em><em>, </em><em>'odd'}</em><em>, </em><em>optional</em>) – the parity of the trajectories in <code class="xref any docutils literal notranslate"><span class="pre">dataset</span></code> under time reversal.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Dest</strong> (<em>float</em>) – estimated KLD in nats</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="tracklib.util.html#tracklib.util.sweep.Sweeper" title="tracklib.util.sweep.Sweeper"><code class="xref py py-func docutils literal notranslate"><span class="pre">tracklib.util.sweep.Sweeper()</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>This function flattens snippets, i.e. if the trajectory has 2 loci and 3
dimensions, the KLD estimation will be run in 6`!n`-dimensional space.
Since this might not be the desired behavior, the user might have to do
some pre-processing.</p>
</dd></dl>

</div>
<div class="section" id="module-tracklib.analysis.p2">
<span id="tracklib-analysis-p2"></span><h2><a class="toc-backref" href="#id4">tracklib.analysis.p2</a><a class="headerlink" href="#module-tracklib.analysis.p2" title="Permalink to this headline">¶</a></h2>
<p>Calculating two-point functions, like MSD &amp; ACF</p>
<p>Note that all of these (MSD, ACF, VACF, …) contain the same information. See
also <code class="xref any docutils literal notranslate"><span class="pre">msdfit</span> <span class="pre">&lt;tracklib.analysis.msdfit]</span></code>.</p>
<p>Many results of this module will be stored in <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory.meta" title="tracklib.trajectory.Trajectory.meta"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">Trajectory.meta</span></code></a> for further
use. For an overview, see <a class="reference internal" href="traj_meta_fields.html#traj-meta-fields-msd"><span class="std std-ref">here</span></a>.</p>
<dl class="function">
<dt id="tracklib.analysis.p2.P2traj">
<code class="sig-prename descclassname">tracklib.analysis.p2.</code><code class="sig-name descname">P2traj</code><span class="sig-paren">(</span><em class="sig-param">traj</em>, <em class="sig-param">TA=True</em>, <em class="sig-param">recalculate=False</em>, <em class="sig-param">function=None</em>, <em class="sig-param">preproc=None</em>, <em class="sig-param">postproc=None</em>, <em class="sig-param">writeto='P2'</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.p2.P2traj" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a two-point function for a single trajectory</p>
<p>The results are stored in the <code class="docutils literal notranslate"><span class="pre">traj.meta[writeto]</span></code>. By default, if this
field exists already, the function aborts. To recalculate and overwrite,
set <code class="docutils literal notranslate"><span class="pre">recalculate</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>traj</strong> (<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><em>Trajectory</em></a>) – the trajectory for which to calculate the MSD</p></li>
<li><p><strong>TA</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to time average</p></li>
</ul>
</dd>
<dt class="field-even">Other Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>recalculate</strong> (<em>bool</em>) – set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to ensure that the calculation is actually performed</p></li>
<li><p><strong>function</strong> (<em>{‘SD’, ‘D’, ‘SP’} or callable</em>) – the function to evaluate. Should be <code class="docutils literal notranslate"><span class="pre">fun(traj[m],</span> <span class="pre">traj[n])</span> <span class="pre">--&gt;</span>
<span class="pre">float</span></code>, where <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">&gt;=</span> <span class="pre">n</span></code>, and it should be vectorized (i.e. work on
numpy arrays and return the corresponding arrays).</p></li>
<li><p><strong>preproc</strong> (<em>callable or None</em>) – will be applied to the trajectory before processing. Example: <code class="docutils literal notranslate"><span class="pre">lambda</span>
<span class="pre">traj:</span> <span class="pre">traj.diff()</span></code> gives the increment trajectory</p></li>
<li><p><strong>postproc</strong> (<em>callable or None</em>) – will be applied to the final result, i.e. should take a (T,) array and
return such. Relevant when accessing this function through
<code class="docutils literal notranslate"><span class="pre">P2dataset</span></code>, since in that case this <code class="xref any docutils literal notranslate"><span class="pre">postproc</span></code> is applied _before_
averaging. Use case: normalizing correlation functions</p></li>
<li><p><strong>writeto</strong> (<em>hashable or None</em>) – where to store the output of the calculation in the <code class="docutils literal notranslate"><span class="pre">traj.meta</span></code> dict.
Set to <code class="docutils literal notranslate"><span class="pre">None</span></code> to return the output dict instead of storing it.
Defaults to <code class="docutils literal notranslate"><span class="pre">'P2'</span></code>.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>dict, optional</em> – A dict with keys <code class="docutils literal notranslate"><span class="pre">'data',</span> <span class="pre">'N'</span></code> giving the averaged data and the count
of valid data points for each lag time. This is usually written into
the <code class="docutils literal notranslate"><span class="pre">traj.meta</span></code> dict, but returned if <code class="docutils literal notranslate"><span class="pre">writeto</span> <span class="pre">is</span> <span class="pre">None</span></code>.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.p2.P2dataset" title="tracklib.analysis.p2.P2dataset"><code class="xref py py-func docutils literal notranslate"><span class="pre">P2dataset()</span></code></a>, <a class="reference internal" href="#tracklib.analysis.p2.MSD" title="tracklib.analysis.p2.MSD"><code class="xref py py-func docutils literal notranslate"><span class="pre">MSD()</span></code></a>, <a class="reference internal" href="tracklib.analysis.msdfit.html#module-tracklib.analysis.msdfit" title="tracklib.analysis.msdfit"><code class="xref py py-func docutils literal notranslate"><span class="pre">tracklib.analysis.msdfit()</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>Explicitly, the <code class="docutils literal notranslate"><span class="pre">recalculate</span></code> parameter is equivalent to
&gt;&gt;&gt; del traj.meta[writeto]</p>
</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.p2.P2dataset">
<code class="sig-prename descclassname">tracklib.analysis.p2.</code><code class="sig-name descname">P2dataset</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">givevar=False</em>, <em class="sig-param">giveN=False</em>, <em class="sig-param">average_in_logspace=False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.p2.P2dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensemble average two-point functions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<a class="reference internal" href="tracklib.html#tracklib.taggedset.TaggedSet" title="tracklib.taggedset.TaggedSet"><em>TaggedSet</em></a>) – a list of <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a></p>
</dd>
<dt class="field-even">Other Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>givevar</strong> (<em>bool, optional</em>) – whether to also return the variance around the mean</p></li>
<li><p><strong>giveN</strong> (<em>bool, optional</em>) – whether to return the sample size for each MSD data point</p></li>
<li><p><strong>average_in_logspace</strong> (<em>bool, optional</em>) – set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to replace the arithmetic with a geometric mean.</p></li>
<li><p><strong>kwargs</strong> (<em>keyword arguments</em>) – are all forwarded to forwarded to <a class="reference internal" href="#tracklib.analysis.p2.P2traj" title="tracklib.analysis.p2.P2traj"><code class="xref any py py-func docutils literal notranslate"><span class="pre">P2traj</span></code></a>, see that docstring.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>eP2</strong> (<em>np.ndarray</em>) – the calculated ensemble mean</p></li>
<li><p><strong>var</strong> (<em>np.ndarray, optional</em>) – variance around the mean</p></li>
<li><p><strong>N</strong> (<em>np.ndarray, optional</em>) – number of data points going into each estimate</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.p2.P2traj" title="tracklib.analysis.p2.P2traj"><code class="xref py py-func docutils literal notranslate"><span class="pre">P2traj()</span></code></a>, <a class="reference internal" href="#tracklib.analysis.p2.MSD" title="tracklib.analysis.p2.MSD"><code class="xref py py-func docutils literal notranslate"><span class="pre">MSD()</span></code></a>, <code class="xref py py-func docutils literal notranslate"><span class="pre">ACF()</span></code></p>
</div>
</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.p2.P2">
<code class="sig-prename descclassname">tracklib.analysis.p2.</code><code class="sig-name descname">P2</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.p2.P2" title="Permalink to this definition">¶</a></dt>
<dd><p>Shortcut function to calculate P2s.</p>
<p>Will select either <a class="reference internal" href="#tracklib.analysis.p2.P2traj" title="tracklib.analysis.p2.P2traj"><code class="xref any py py-func docutils literal notranslate"><span class="pre">P2traj</span></code></a> or <a class="reference internal" href="#tracklib.analysis.p2.P2dataset" title="tracklib.analysis.p2.P2dataset"><code class="xref any py py-func docutils literal notranslate"><span class="pre">P2dataset</span></code></a>, depending on the type of the
first argument. Everything is then forwarded to that function.</p>
<p>This is mostly just a template for the following functions MSD, ACF, …</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.p2.P2traj" title="tracklib.analysis.p2.P2traj"><code class="xref py py-func docutils literal notranslate"><span class="pre">P2traj()</span></code></a>, <a class="reference internal" href="#tracklib.analysis.p2.P2dataset" title="tracklib.analysis.p2.P2dataset"><code class="xref py py-func docutils literal notranslate"><span class="pre">P2dataset()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.p2.MSD">
<code class="sig-prename descclassname">tracklib.analysis.p2.</code><code class="sig-name descname">MSD</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.p2.MSD" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate MSD for a <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a> or dataset.</p>
<p>This is an implementation of <a class="reference internal" href="#tracklib.analysis.p2.P2" title="tracklib.analysis.p2.P2"><code class="xref any py py-func docutils literal notranslate"><span class="pre">P2</span></code></a>. See <a class="reference internal" href="#tracklib.analysis.p2.P2traj" title="tracklib.analysis.p2.P2traj"><code class="xref any py py-func docutils literal notranslate"><span class="pre">P2traj</span></code></a> and <a class="reference internal" href="#tracklib.analysis.p2.P2dataset" title="tracklib.analysis.p2.P2dataset"><code class="xref any py py-func docutils literal notranslate"><span class="pre">P2dataset</span></code></a> for
detailed description of parameters, here we will just list the most
interesting / relevant ones</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in</strong> (<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><em>Trajectory</em></a><em> or </em><em>TaggedSet of Trajectory</em>) – the first argument is the input data, either a single <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>, or
a dataset that will be ensemble averaged over</p></li>
<li><p><strong>TA</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to time average on (each) single trajectory</p></li>
<li><p><strong>recalculate</strong> (<em>bool</em><em>, </em><em>optional</em>) – set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to ensure that the calculation is actually performed.
Otherwise, this function might just return precalculated values from
<code class="docutils literal notranslate"><span class="pre">traj.meta['MSD']</span></code>.</p></li>
<li><p><strong>giveN</strong> (<em>bool</em><em>, </em><em>optional</em>) – only applicable when <code class="xref any docutils literal notranslate"><span class="pre">in</span></code> is a dataset. Whether to also return the
sample size for each MSD data point.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>msd</strong> (<em>np.ndarray</em>) – the calculated MSD. Note that <code class="docutils literal notranslate"><span class="pre">msd[i]</span> <span class="pre">=</span> <span class="pre">MSD(iΔt)</span></code>, i.e. <code class="docutils literal notranslate"><span class="pre">msd[0]</span> <span class="pre">=</span>
<span class="pre">0</span></code>.</p></li>
<li><p><strong>N</strong> (<em>np.ndarray, optional</em>) – the sample size for each point, see <code class="xref any docutils literal notranslate"><span class="pre">giveN</span></code>.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.p2.P2traj" title="tracklib.analysis.p2.P2traj"><code class="xref py py-func docutils literal notranslate"><span class="pre">P2traj()</span></code></a>, <a class="reference internal" href="#tracklib.analysis.p2.P2dataset" title="tracklib.analysis.p2.P2dataset"><code class="xref py py-func docutils literal notranslate"><span class="pre">P2dataset()</span></code></a>, <a class="reference internal" href="tracklib.analysis.msdfit.html#module-tracklib.analysis.msdfit" title="tracklib.analysis.msdfit"><code class="xref py py-func docutils literal notranslate"><span class="pre">tracklib.analysis.msdfit()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.p2.ACov">
<code class="sig-prename descclassname">tracklib.analysis.p2.</code><code class="sig-name descname">ACov</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.p2.ACov" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate autocovariance for a <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a> or dataset.</p>
<p>This is an implementation of <a class="reference internal" href="#tracklib.analysis.p2.P2" title="tracklib.analysis.p2.P2"><code class="xref any py py-func docutils literal notranslate"><span class="pre">P2</span></code></a>. See <a class="reference internal" href="#tracklib.analysis.p2.P2traj" title="tracklib.analysis.p2.P2traj"><code class="xref any py py-func docutils literal notranslate"><span class="pre">P2traj</span></code></a> and <a class="reference internal" href="#tracklib.analysis.p2.P2dataset" title="tracklib.analysis.p2.P2dataset"><code class="xref any py py-func docutils literal notranslate"><span class="pre">P2dataset</span></code></a> for
detailed description of parameters, here we will just list the most
interesting / relevant ones</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in</strong> (<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><em>Trajectory</em></a><em> or </em><em>TaggedSet of Trajectory</em>) – the first argument is the input data, either a single <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>, or
a dataset that will be ensemble averaged over</p></li>
<li><p><strong>TA</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to time average on (each) single trajectory</p></li>
<li><p><strong>recalculate</strong> (<em>bool</em><em>, </em><em>optional</em>) – set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to ensure that the calculation is actually performed.
Otherwise, this function might just return precalculated values from
<code class="docutils literal notranslate"><span class="pre">traj.meta['ACov']</span></code>.</p></li>
<li><p><strong>giveN</strong> (<em>bool</em><em>, </em><em>optional</em>) – only applicable when <code class="xref any docutils literal notranslate"><span class="pre">in</span></code> is a dataset. Whether to also return the
sample size for each data point.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>acov</strong> (<em>np.ndarray</em>) – the calculated autocovariance</p></li>
<li><p><strong>N</strong> (<em>np.ndarray, optional</em>) – the sample size for each point, see <code class="xref any docutils literal notranslate"><span class="pre">giveN</span></code></p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.p2.MSD" title="tracklib.analysis.p2.MSD"><code class="xref py py-func docutils literal notranslate"><span class="pre">MSD()</span></code></a>, <a class="reference internal" href="#tracklib.analysis.p2.P2traj" title="tracklib.analysis.p2.P2traj"><code class="xref py py-func docutils literal notranslate"><span class="pre">P2traj()</span></code></a>, <a class="reference internal" href="#tracklib.analysis.p2.P2dataset" title="tracklib.analysis.p2.P2dataset"><code class="xref py py-func docutils literal notranslate"><span class="pre">P2dataset()</span></code></a>, <a class="reference internal" href="tracklib.analysis.msdfit.html#module-tracklib.analysis.msdfit" title="tracklib.analysis.msdfit"><code class="xref py py-func docutils literal notranslate"><span class="pre">tracklib.analysis.msdfit()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.p2.ACorr">
<code class="sig-prename descclassname">tracklib.analysis.p2.</code><code class="sig-name descname">ACorr</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.p2.ACorr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate autocorrelation for a <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a> or dataset.</p>
<p>This is an implementation of <a class="reference internal" href="#tracklib.analysis.p2.P2" title="tracklib.analysis.p2.P2"><code class="xref any py py-func docutils literal notranslate"><span class="pre">P2</span></code></a>. See <a class="reference internal" href="#tracklib.analysis.p2.P2traj" title="tracklib.analysis.p2.P2traj"><code class="xref any py py-func docutils literal notranslate"><span class="pre">P2traj</span></code></a> and <a class="reference internal" href="#tracklib.analysis.p2.P2dataset" title="tracklib.analysis.p2.P2dataset"><code class="xref any py py-func docutils literal notranslate"><span class="pre">P2dataset</span></code></a> for
detailed description of parameters, here we will just list the most
interesting / relevant ones</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in</strong> (<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><em>Trajectory</em></a><em> or </em><em>TaggedSet of Trajectory</em>) – the first argument is the input data, either a single <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>, or
a dataset that will be ensemble averaged over</p></li>
<li><p><strong>TA</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to time average on (each) single trajectory</p></li>
<li><p><strong>recalculate</strong> (<em>bool</em><em>, </em><em>optional</em>) – set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to ensure that the calculation is actually performed.
Otherwise, this function might just return precalculated values from
<code class="docutils literal notranslate"><span class="pre">traj.meta['ACorr']</span></code>.</p></li>
<li><p><strong>giveN</strong> (<em>bool</em><em>, </em><em>optional</em>) – only applicable when <code class="xref any docutils literal notranslate"><span class="pre">in</span></code> is a dataset. Whether to also return the
sample size for each data point.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>acorr</strong> (<em>np.ndarray</em>) – the calculated autocorrelation</p></li>
<li><p><strong>N</strong> (<em>np.ndarray, optional</em>) – the sample size for each point, see <code class="xref any docutils literal notranslate"><span class="pre">giveN</span></code></p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.p2.MSD" title="tracklib.analysis.p2.MSD"><code class="xref py py-func docutils literal notranslate"><span class="pre">MSD()</span></code></a>, <a class="reference internal" href="#tracklib.analysis.p2.P2traj" title="tracklib.analysis.p2.P2traj"><code class="xref py py-func docutils literal notranslate"><span class="pre">P2traj()</span></code></a>, <a class="reference internal" href="#tracklib.analysis.p2.P2dataset" title="tracklib.analysis.p2.P2dataset"><code class="xref py py-func docutils literal notranslate"><span class="pre">P2dataset()</span></code></a>, <a class="reference internal" href="tracklib.analysis.msdfit.html#module-tracklib.analysis.msdfit" title="tracklib.analysis.msdfit"><code class="xref py py-func docutils literal notranslate"><span class="pre">tracklib.analysis.msdfit()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.p2.VACov">
<code class="sig-prename descclassname">tracklib.analysis.p2.</code><code class="sig-name descname">VACov</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.p2.VACov" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate velocity autocovariance for a <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a> or dataset.</p>
<p>This is an implementation of <a class="reference internal" href="#tracklib.analysis.p2.P2" title="tracklib.analysis.p2.P2"><code class="xref any py py-func docutils literal notranslate"><span class="pre">P2</span></code></a>. See <a class="reference internal" href="#tracklib.analysis.p2.P2traj" title="tracklib.analysis.p2.P2traj"><code class="xref any py py-func docutils literal notranslate"><span class="pre">P2traj</span></code></a> and <a class="reference internal" href="#tracklib.analysis.p2.P2dataset" title="tracklib.analysis.p2.P2dataset"><code class="xref any py py-func docutils literal notranslate"><span class="pre">P2dataset</span></code></a> for
detailed description of parameters, here we will just list the most
interesting / relevant ones</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in</strong> (<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><em>Trajectory</em></a><em> or </em><em>TaggedSet of Trajectory</em>) – the first argument is the input data, either a single <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>, or
a dataset that will be ensemble averaged over</p></li>
<li><p><strong>TA</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to time average on (each) single trajectory</p></li>
<li><p><strong>recalculate</strong> (<em>bool</em><em>, </em><em>optional</em>) – set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to ensure that the calculation is actually performed.
Otherwise, this function might just return precalculated values from
<code class="docutils literal notranslate"><span class="pre">traj.meta['VACov']</span></code>.</p></li>
<li><p><strong>giveN</strong> (<em>bool</em><em>, </em><em>optional</em>) – only applicable when <code class="xref any docutils literal notranslate"><span class="pre">in</span></code> is a dataset. Whether to also return the
sample size for each data point.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>vacov</strong> (<em>np.ndarray</em>) – the calculated velocity autocovariance</p></li>
<li><p><strong>N</strong> (<em>np.ndarray, optional</em>) – the sample size for each point, see <code class="xref any docutils literal notranslate"><span class="pre">giveN</span></code></p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.p2.MSD" title="tracklib.analysis.p2.MSD"><code class="xref py py-func docutils literal notranslate"><span class="pre">MSD()</span></code></a>, <a class="reference internal" href="#tracklib.analysis.p2.P2traj" title="tracklib.analysis.p2.P2traj"><code class="xref py py-func docutils literal notranslate"><span class="pre">P2traj()</span></code></a>, <a class="reference internal" href="#tracklib.analysis.p2.P2dataset" title="tracklib.analysis.p2.P2dataset"><code class="xref py py-func docutils literal notranslate"><span class="pre">P2dataset()</span></code></a>, <a class="reference internal" href="tracklib.analysis.msdfit.html#module-tracklib.analysis.msdfit" title="tracklib.analysis.msdfit"><code class="xref py py-func docutils literal notranslate"><span class="pre">tracklib.analysis.msdfit()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.p2.VACorr">
<code class="sig-prename descclassname">tracklib.analysis.p2.</code><code class="sig-name descname">VACorr</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.p2.VACorr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate velocity autocorrelation for a <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a> or dataset.</p>
<p>This is an implementation of <a class="reference internal" href="#tracklib.analysis.p2.P2" title="tracklib.analysis.p2.P2"><code class="xref any py py-func docutils literal notranslate"><span class="pre">P2</span></code></a>. See <a class="reference internal" href="#tracklib.analysis.p2.P2traj" title="tracklib.analysis.p2.P2traj"><code class="xref any py py-func docutils literal notranslate"><span class="pre">P2traj</span></code></a> and <a class="reference internal" href="#tracklib.analysis.p2.P2dataset" title="tracklib.analysis.p2.P2dataset"><code class="xref any py py-func docutils literal notranslate"><span class="pre">P2dataset</span></code></a> for
detailed description of parameters, here we will just list the most
interesting / relevant ones</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in</strong> (<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><em>Trajectory</em></a><em> or </em><em>TaggedSet of Trajectory</em>) – the first argument is the input data, either a single <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>, or
a dataset that will be ensemble averaged over</p></li>
<li><p><strong>TA</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to time average on (each) single trajectory</p></li>
<li><p><strong>recalculate</strong> (<em>bool</em><em>, </em><em>optional</em>) – set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to ensure that the calculation is actually performed.
Otherwise, this function might just return precalculated values from
<code class="docutils literal notranslate"><span class="pre">traj.meta['VACorr']</span></code>.</p></li>
<li><p><strong>giveN</strong> (<em>bool</em><em>, </em><em>optional</em>) – only applicable when <code class="xref any docutils literal notranslate"><span class="pre">in</span></code> is a dataset. Whether to also return the
sample size for each data point.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>vacorr</strong> (<em>np.ndarray</em>) – the calculated velocity autocorrelation</p></li>
<li><p><strong>N</strong> (<em>np.ndarray, optional</em>) – the sample size for each point, see <code class="xref any docutils literal notranslate"><span class="pre">giveN</span></code></p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.p2.MSD" title="tracklib.analysis.p2.MSD"><code class="xref py py-func docutils literal notranslate"><span class="pre">MSD()</span></code></a>, <a class="reference internal" href="#tracklib.analysis.p2.P2traj" title="tracklib.analysis.p2.P2traj"><code class="xref py py-func docutils literal notranslate"><span class="pre">P2traj()</span></code></a>, <a class="reference internal" href="#tracklib.analysis.p2.P2dataset" title="tracklib.analysis.p2.P2dataset"><code class="xref py py-func docutils literal notranslate"><span class="pre">P2dataset()</span></code></a>, <a class="reference internal" href="tracklib.analysis.msdfit.html#module-tracklib.analysis.msdfit" title="tracklib.analysis.msdfit"><code class="xref py py-func docutils literal notranslate"><span class="pre">tracklib.analysis.msdfit()</span></code></a></p>
</div>
</dd></dl>

</div>
<div class="section" id="module-tracklib.analysis.plots">
<span id="tracklib-analysis-plots"></span><h2><a class="toc-backref" href="#id5">tracklib.analysis.plots</a><a class="headerlink" href="#module-tracklib.analysis.plots" title="Permalink to this headline">¶</a></h2>
<p>A module to quickly produce some overview plots</p>
<dl class="function">
<dt id="tracklib.analysis.plots.length_distribution">
<code class="sig-prename descclassname">tracklib.analysis.plots.</code><code class="sig-name descname">length_distribution</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">ax=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.plots.length_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a histogram of trajectory lengths for the given dataset</p>
<p>All keyword arguments will be forwarded to <code class="xref any docutils literal notranslate"><span class="pre">plt.hist()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<a class="reference internal" href="tracklib.html#tracklib.taggedset.TaggedSet" title="tracklib.taggedset.TaggedSet"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TaggedSet</span></code></a> of <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>) – the dataset to use</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axes</em><em>, </em><em>optional</em>) – the axes to plot in. If not specified, plot in <code class="docutils literal notranslate"><span class="pre">plt.gca()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>tuple</em> – the return value of <code class="xref any docutils literal notranslate"><span class="pre">plt.hist()</span></code>, i.e. a tuple <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">bins,</span> <span class="pre">patches)</span></code></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This should be thought of only as a quickshot way to take a look at the
data. For more elaborate plotting, obtain the trajectory lengths as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lengths</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span> <span class="k">for</span> <span class="n">traj</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">]</span>
</pre></div>
</div>
<p>and produce a plot to your liking.</p>
</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.plots.msd_overview">
<code class="sig-prename descclassname">tracklib.analysis.plots.</code><code class="sig-name descname">msd_overview</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">dt=1.0</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.plots.msd_overview" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot individual and ensemble MSDs of the given dataset</p>
<p>All keyword arguments are forwarded to <code class="xref any docutils literal notranslate"><span class="pre">plt.loglog()</span></code> for plotting of the
individual trajectory MSDs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<a class="reference internal" href="tracklib.html#tracklib.taggedset.TaggedSet" title="tracklib.taggedset.TaggedSet"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TaggedSet</span></code></a> of <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>) – the dataset to use</p></li>
<li><p><strong>dt</strong> (<em>float</em><em> or </em><em>(</em><em>float</em><em>, </em><em>str</em><em>) </em><em>tuple</em><em>, </em><em>optional</em>) – the time step between two frames of the trajectory. This will simply
rescale the horizontal axis of the plot. Optionally, give a string to
identify the units, e.g. <code class="docutils literal notranslate"><span class="pre">dt</span> <span class="pre">=</span> <span class="pre">(2,</span> <span class="pre">'seconds')</span></code> if your trajectories
have a lapse time of 2 seconds. Note that you might want to set
<code class="xref any docutils literal notranslate"><span class="pre">plt.xlabel()</span></code> yourself if you omit the unit string.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>list of lines</em> – aggregate of the <code class="docutils literal notranslate"><span class="pre">plt.plot()</span></code> outputs</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Only intended as a quick overview plot, for more customization write your
own plotting routine using <code class="xref any docutils literal notranslate"><span class="pre">analysis.MSD</span></code></p>
</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.plots.trajectories_spatial">
<code class="sig-prename descclassname">tracklib.analysis.plots.</code><code class="sig-name descname">trajectories_spatial</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.plots.trajectories_spatial" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the trajectories in the given dataset.</p>
<p>Additional keyword arguments will be forwarded to
<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory.plot_spatial" title="tracklib.trajectory.Trajectory.plot_spatial"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Trajectory.plot_spatial</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<a class="reference internal" href="tracklib.html#tracklib.taggedset.TaggedSet" title="tracklib.taggedset.TaggedSet"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TaggedSet</span></code></a> of <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>) – the set of trajectories to plot</p>
</dd>
<dt class="field-even">Keyword Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>colordict</strong> (<em>dict</em>) – determines which tag is colored in which color. This should be a dict
whose keys are the tags in the dataset, while the entries are anything
recognized by the <code class="xref any docutils literal notranslate"><span class="pre">'color'</span></code> kwarg of <code class="xref any docutils literal notranslate"><span class="pre">plt.plot()</span></code>. If omitted, will
cycle through the default color cycle.</p></li>
<li><p><strong>fallback_color</strong> (<em>str</em><em>, or </em><em>RGB tuple</em>) – the color to use for anything not appearing in <code class="xref any docutils literal notranslate"><span class="pre">'colordict'</span></code></p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>list of lines</em> – the aggregated output of <code class="xref any docutils literal notranslate"><span class="pre">plt.plot()</span></code></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Each tag will be associated with one color, and trajectories will be
colored by one of the tags they’re associated with.  There is no way to
determine which one.</p>
</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.plots.distance_distribution">
<code class="sig-prename descclassname">tracklib.analysis.plots.</code><code class="sig-name descname">distance_distribution</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">ax=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.plots.distance_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw a histogram of distances.</p>
<p>For two-locus trajectories, this is the absolute distance between the loci,
for single locus trajectories it is simply the absolute value of the
trajectory.</p>
<p>All keyword arguments will be forwarded to <code class="xref any docutils literal notranslate"><span class="pre">plt.hist()</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<a class="reference internal" href="tracklib.html#tracklib.taggedset.TaggedSet" title="tracklib.taggedset.TaggedSet"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TaggedSet</span></code></a> of <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>) – the trajectories to use</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axes</em><em>, </em><em>optional</em>) – the axes to plot in. If not specified, plot in <code class="docutils literal notranslate"><span class="pre">plt.gca()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>tuple</em> – the output of <code class="xref any docutils literal notranslate"><span class="pre">plt.hist()</span></code>, i.e. a tuple <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">bins,</span> <span class="pre">patches)</span></code>.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is intended for gaining a quick overview. For more elaborate tasks,
obtain the distances as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">traj</span><span class="p">[:]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="k">for</span> <span class="n">traj</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="o">&lt;</span><span class="n">preproc</span><span class="o">&gt;</span><span class="p">)])</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">&lt;preproc&gt;</span></code> is the preprocessing function appropriate for your
dataset.  For a two-locus trajectory, this would presumably be</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">preproc</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">traj</span> <span class="p">:</span> <span class="n">traj</span><span class="o">.</span><span class="n">relative</span><span class="p">()</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-tracklib.analysis.vacf">
<span id="tracklib-analysis-vacf"></span><h2><a class="toc-backref" href="#id6">tracklib.analysis.vacf</a><a class="headerlink" href="#module-tracklib.analysis.vacf" title="Permalink to this headline">¶</a></h2>
<p>A module for calculating velocity autocorrelations.</p>
<p>Follows the structure of <code class="xref any docutils literal notranslate"><span class="pre">tracklib.analysis.msd</span></code>.</p>
<dl class="function">
<dt id="tracklib.analysis.vacf.VACFtraj">
<code class="sig-prename descclassname">tracklib.analysis.vacf.</code><code class="sig-name descname">VACFtraj</code><span class="sig-paren">(</span><em class="sig-param">traj</em>, <em class="sig-param">dt=1</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.vacf.VACFtraj" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate/give velocity autocorrelation for a single trajectory.</p>
<p>The result of the calculation is stored in <code class="docutils literal notranslate"><span class="pre">traj.meta['VACF']</span></code> and
<code class="docutils literal notranslate"><span class="pre">traj.meta['VACFmeta']</span></code>. This function checks whether the corresponding
fields exist and if not calculates them. It then returns the value of the
<code class="xref any docutils literal notranslate"><span class="pre">'VACF'</span></code> entry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>traj</strong> (<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><em>Trajectory</em></a>) – the trajectory whose velocity autocorrelation function to calculate</p></li>
<li><p><strong>dt</strong> (<em>int</em><em>, </em><em>optional</em>) – the time step to use for displacements. If <code class="docutils literal notranslate"><span class="pre">dt</span> <span class="pre">&gt;</span> <span class="pre">1</span></code>, we average over
the <code class="xref any docutils literal notranslate"><span class="pre">dt</span></code> realizations of the downsampling.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>VACF</strong> (<em>np.ndarray</em>) – the velocity autocorrelation function of the trajectory. This is
normalized such that <code class="docutils literal notranslate"><span class="pre">VACF[0]</span> <span class="pre">=</span> <span class="pre">1</span></code>.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.vacf.VACFdataset" title="tracklib.analysis.vacf.VACFdataset"><code class="xref py py-func docutils literal notranslate"><span class="pre">VACFdataset()</span></code></a>, <a class="reference internal" href="#tracklib.analysis.vacf.VACF" title="tracklib.analysis.vacf.VACF"><code class="xref py py-func docutils literal notranslate"><span class="pre">VACF()</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>This function expects a single-locus trajectory (<code class="docutils literal notranslate"><span class="pre">N=1</span></code>) and will raise a
<code class="xref any docutils literal notranslate"><span class="pre">ValueError</span></code> otherwise. Preprocess accordingly.</p>
<p>Usually this function should always be preferred to accessing
<code class="docutils literal notranslate"><span class="pre">traj.meta['VACF']</span></code> directly.</p>
</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.vacf.VACFdataset">
<code class="sig-prename descclassname">tracklib.analysis.vacf.</code><code class="sig-name descname">VACFdataset</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">dt=1</em>, <em class="sig-param">givevar=False</em>, <em class="sig-param">giveN=False</em>, <em class="sig-param">average_in_logspace=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.vacf.VACFdataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate ensemble VACF for the given dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<a class="reference internal" href="tracklib.html#tracklib.taggedset.TaggedSet" title="tracklib.taggedset.TaggedSet"><em>TaggedSet</em></a>) – a list of <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a> for which to calculate an ensemble VACF</p></li>
<li><p><strong>dt</strong> (<em>int</em><em>, </em><em>optional</em>) – step size for displacements</p></li>
<li><p><strong>givevar</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to also return the variance around the mean</p></li>
<li><p><strong>giveN</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to return the sample size for each VACF data point</p></li>
<li><p><strong>average_in_logspace</strong> (<em>bool</em><em>, </em><em>optional</em>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, the averages used to calculate mean and variance will be
taken in log-space, i.e. <code class="docutils literal notranslate"><span class="pre">exp(mean(log(...)))</span></code> instead of
<code class="docutils literal notranslate"><span class="pre">mean(...)</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>vacf</strong> (<em>np.ndarray</em>) – the calculated ensemble mean</p></li>
<li><p><strong>var</strong> (<em>np.ndarray, optional</em>) – variance around the mean</p></li>
<li><p><strong>N</strong> (<em>np.ndarray, optional</em>) – number of data points going into each estimate</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.vacf.VACFtraj" title="tracklib.analysis.vacf.VACFtraj"><code class="xref py py-func docutils literal notranslate"><span class="pre">VACFtraj()</span></code></a>, <a class="reference internal" href="#tracklib.analysis.vacf.VACF" title="tracklib.analysis.vacf.VACF"><code class="xref py py-func docutils literal notranslate"><span class="pre">VACF()</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>We normalize such that <code class="docutils literal notranslate"><span class="pre">vacf[0]</span> <span class="pre">=</span> <span class="pre">1</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.vacf.VACF">
<code class="sig-prename descclassname">tracklib.analysis.vacf.</code><code class="sig-name descname">VACF</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.vacf.VACF" title="Permalink to this definition">¶</a></dt>
<dd><p>Shortcut function to calculate VACFs.</p>
<p>Will select either <a class="reference internal" href="#tracklib.analysis.vacf.VACFtraj" title="tracklib.analysis.vacf.VACFtraj"><code class="xref any py py-func docutils literal notranslate"><span class="pre">VACFtraj</span></code></a> or <a class="reference internal" href="#tracklib.analysis.vacf.VACFdataset" title="tracklib.analysis.vacf.VACFdataset"><code class="xref any py py-func docutils literal notranslate"><span class="pre">VACFdataset</span></code></a>, depending on the type of the
first argument. Everything is then forwarded to that function.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.vacf.VACFtraj" title="tracklib.analysis.vacf.VACFtraj"><code class="xref py py-func docutils literal notranslate"><span class="pre">VACFtraj()</span></code></a>, <a class="reference internal" href="#tracklib.analysis.vacf.VACFdataset" title="tracklib.analysis.vacf.VACFdataset"><code class="xref py py-func docutils literal notranslate"><span class="pre">VACFdataset()</span></code></a></p>
</div>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">tracklib.analysis</a><ul>
<li><a class="reference internal" href="#tracklib-analysis-msdfit-old">tracklib.analysis..msdfit_old</a></li>
<li><a class="reference internal" href="#module-tracklib.analysis.chi2">tracklib.analysis.chi2</a></li>
<li><a class="reference internal" href="#module-tracklib.analysis.kld">tracklib.analysis.kld</a></li>
<li><a class="reference internal" href="#module-tracklib.analysis.p2">tracklib.analysis.p2</a></li>
<li><a class="reference internal" href="#module-tracklib.analysis.plots">tracklib.analysis.plots</a></li>
<li><a class="reference internal" href="#module-tracklib.analysis.vacf">tracklib.analysis.vacf</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="tracklib.html"
                        title="previous chapter">tracklib</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tracklib.analysis.bild.html"
                        title="next chapter">tracklib.analysis.bild</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tracklib.analysis.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tracklib.analysis.bild.html" title="tracklib.analysis.bild"
             >next</a> |</li>
        <li class="right" >
          <a href="tracklib.html" title="tracklib"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">tracklib 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="tracklib.html" >tracklib</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Simon Grosse-Holz.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.1.2.
    </div>
  </body>
</html>