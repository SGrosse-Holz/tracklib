
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>tracklib.models package &#8212; tracklib 0.1 documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">tracklib 0.1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tracklib-models-package">
<h1>tracklib.models package<a class="headerlink" href="#tracklib-models-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-tracklib.models.rouse">
<span id="tracklib-models-rouse-module"></span><h2>tracklib.models.rouse module<a class="headerlink" href="#module-tracklib.models.rouse" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="tracklib.models.rouse.Model">
<em class="property">class </em><code class="sig-prename descclassname">tracklib.models.rouse.</code><code class="sig-name descname">Model</code><span class="sig-paren">(</span><em class="sig-param">N</em>, <em class="sig-param">D</em>, <em class="sig-param">k</em>, <em class="sig-param">k_extra</em>, <em class="sig-param">setup=True</em>, <em class="sig-param">extrabond=(0</em>, <em class="sig-param">-1)</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.models.rouse.Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Note: if k_extra &lt; -k/(N-1) the connectivity matrix will have a negative
eigenvalue. In this situation there is a repulsive bond between the ends
that is stronger than the backbone, so it will tear the polymer apart. The
model can still be useful in this limit, but if the extra bond is switched
on too much, it will tear everything apart. This can also lead to negative
covariance matrices.</p>
<dl class="method">
<dt id="tracklib.models.rouse.Model.__eq__">
<code class="sig-name descname">__eq__</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.models.rouse.Model.__eq__" title="Permalink to this definition">¶</a></dt>
<dd><p>Models are equal if all the parameters are equal.</p>
</dd></dl>

<dl class="method">
<dt id="tracklib.models.rouse.Model.give_matrices">
<code class="sig-name descname">give_matrices</code><span class="sig-paren">(</span><em class="sig-param">bond</em>, <em class="sig-param">tethered=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.models.rouse.Model.give_matrices" title="Permalink to this definition">¶</a></dt>
<dd><p>Assemble the matrices needed for evolution of the Rouse model</p>
<dl class="simple">
<dt>bond<span class="classifier">bool</span></dt><dd><p>is the extra bond present?</p>
</dd>
<dt>tethered<span class="classifier">bool</span></dt><dd><p>set to True to tether monomer 0 to the origin, i.e. get a non-singular A
default: False</p>
</dd>
</dl>
<p>A : the transition matrix for the deterministic part of the equation
S : covariance of the noise</p>
</dd></dl>

<dl class="method">
<dt id="tracklib.models.rouse.Model.setup_propagation">
<code class="sig-name descname">setup_propagation</code><span class="sig-paren">(</span><em class="sig-param">dt=1</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.models.rouse.Model.setup_propagation" title="Permalink to this definition">¶</a></dt>
<dd><p>Pre-calculate the matrices needed for propagation using the analytical
solution</p>
</dd></dl>

<dl class="method">
<dt id="tracklib.models.rouse.Model.check_propagation_memo_uptodate">
<code class="sig-name descname">check_propagation_memo_uptodate</code><span class="sig-paren">(</span><em class="sig-param">dt=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.models.rouse.Model.check_propagation_memo_uptodate" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether the internal storage variable _propagation_memo exists
and is up to date with the current parameters.</p>
</dd></dl>

<dl class="method">
<dt id="tracklib.models.rouse.Model.conf_ss">
<code class="sig-name descname">conf_ss</code><span class="sig-paren">(</span><em class="sig-param">bond=False</em>, <em class="sig-param">d=3</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.models.rouse.Model.conf_ss" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw a conformation from steady state. To guarantee existence of a
steady state, we tether one end of the chain to the origin.</p>
</dd></dl>

<dl class="method">
<dt id="tracklib.models.rouse.Model.evolve">
<code class="sig-name descname">evolve</code><span class="sig-paren">(</span><em class="sig-param">conf</em>, <em class="sig-param">bond=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.models.rouse.Model.evolve" title="Permalink to this definition">¶</a></dt>
<dd><p>Evolve the conformation conf for the timestep given to setup_propagation()</p>
<dl class="simple">
<dt>conf<span class="classifier">(N, …) np.ndarray</span></dt><dd><p>the conformation(s) to evolve</p>
</dd>
<dt>bond<span class="classifier">bool</span></dt><dd><p>whether to use the bound or unbound model</p>
</dd>
</dl>
<p>the evolved conformation</p>
</dd></dl>

<dl class="method">
<dt id="tracklib.models.rouse.Model.conformations_from_looptrace">
<code class="sig-name descname">conformations_from_looptrace</code><span class="sig-paren">(</span><em class="sig-param">looptrace</em>, <em class="sig-param">d=3</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.models.rouse.Model.conformations_from_looptrace" title="Permalink to this definition">¶</a></dt>
<dd><p>A generator yielding conformations for a given looptrace. We start from
steady state with/without the extra bond according to looptrace[0] and
evolve from there. This means that looptrace[i] can be seen as the
indicator for whether or not there is a bond present between time
points i-1 and i.</p>
<dl class="simple">
<dt>looptrace<span class="classifier">(T,) iterable of bool</span></dt><dd><p>the looptrace to simulate for</p>
</dd>
<dt>d<span class="classifier">int</span></dt><dd><p>the dimensionality of the conformations to generate
default: 3</p>
</dd>
</dl>
<p>A generator yielding T conformations sampled according to looptrace.</p>
</dd></dl>

<dl class="method">
<dt id="tracklib.models.rouse.Model.propagate">
<code class="sig-name descname">propagate</code><span class="sig-paren">(</span><em class="sig-param">M0</em>, <em class="sig-param">C0</em>, <em class="sig-param">t</em>, <em class="sig-param">bond</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.models.rouse.Model.propagate" title="Permalink to this definition">¶</a></dt>
<dd><p>Propagate M0 and C0 using the analytical solution to the equations used
by _propagate_ode.</p>
<p>Note: call setup_propagation before using this. Failing to do so will
raise a RuntimeError.
Speedup over _propagate_ode is roughly 8x.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="tracklib.models.rouse.likelihood">
<code class="sig-prename descclassname">tracklib.models.rouse.</code><code class="sig-name descname">likelihood</code><span class="sig-paren">(</span><em class="sig-param">trace</em>, <em class="sig-param">looptrace</em>, <em class="sig-param">model</em>, <em class="sig-param">*</em>, <em class="sig-param">noise</em>, <em class="sig-param">w=None</em>, <em class="sig-param">times=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.models.rouse.likelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate log likelihood for the given combination of
trace, looping sequence, and model.</p>
<dl class="simple">
<dt>trace<span class="classifier">(T,) array</span></dt><dd><p>the distance trace</p>
</dd>
<dt>looptrace<span class="classifier">(T,) array, dtype=bool</span></dt><dd><p>for which steps there is a loop. looptrace[i] indicates that
there is a loop during the evolution from trace[i-1] to trace[i]
and looptrace[0] is the value used for initialization.</p>
</dd>
<dt>model<span class="classifier">Model</span></dt><dd><p>the model to use for likelihood calculation</p>
</dd>
<dt>noise<span class="classifier">float</span></dt><dd><p>the localization error on each trace</p>
</dd>
<dt>w<span class="classifier">(N,) array</span></dt><dd><p>the measurement vector
default: (1, 0, …, 0, -1) (i.e. end-to-end distance)</p>
</dd>
<dt>times<span class="classifier">(T,) array</span></dt><dd><p>the times at which the trace is evaluated
default: np.arange(T)</p>
</dd>
</dl>
<dl class="simple">
<dt>logL<span class="classifier">float</span></dt><dd><p>the calculated log-likelihood</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>We assume that the ensemble starts from steady state.
This is filterData in Christoph’s / Hugo’s code</p>
</dd></dl>

</div>
<div class="section" id="module-tracklib.models.statgauss">
<span id="tracklib-models-statgauss-module"></span><h2>tracklib.models.statgauss module<a class="headerlink" href="#module-tracklib.models.statgauss" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="tracklib.models.statgauss.sampleMSD">
<code class="sig-prename descclassname">tracklib.models.statgauss.</code><code class="sig-name descname">sampleMSD</code><span class="sig-paren">(</span><em class="sig-param">msd</em>, <em class="sig-param">n=1</em>, <em class="sig-param">isCorr=False</em>, <em class="sig-param">subtractMean=True</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.models.statgauss.sampleMSD" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample trajectories from a Gaussian process with zero-mean stationary
increments with given autocorrelation function γ(k). Usually the more
intuitive quantity is the MSD of the process, so by default we expect the
MSD μ(k) to be given. They are related by
<a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">`</span></a></p>
<blockquote>
<div><p>γ(k) = 1/2 * ( μ(<a href="#id9"><span class="problematic" id="id10">|k+1|</span></a>) + μ(<a href="#id11"><span class="problematic" id="id12">|k-1|</span></a>) - 2*μ(<a href="#id13"><span class="problematic" id="id14">|k|</span></a>) ) .</p>
</div></blockquote>
<p><a href="#id5"><span class="problematic" id="id6">``</span></a><a href="#id7"><span class="problematic" id="id8">`</span></a></p>
<dl class="simple">
<dt>msd<span class="classifier">(N, ) array</span></dt><dd><p>The msd from which to sample. The trajectories will have length N-1 and
msd[0] should be 0, such that generally msd[k] is the MSD for a time
lag of k*Δt. If isCorr = True, then this is expected to be the
autocorrelation function already, instead of the MSD. In this case, the
trajectories will have length N.</p>
</dd>
<dt>n<span class="classifier">integer</span></dt><dd><p>Number of trajectories to generate
default: 1</p>
</dd>
<dt>isCorr<span class="classifier">whether the input array is MSD or autocorrelation.</span></dt><dd><p>default: False, i.e. input is MSD.</p>
</dd>
<dt>subtractMean<span class="classifier">whether to subtract the mean of each trajectory. See Notes</span></dt><dd><p>below
default: True</p>
</dd>
</dl>
<dl class="simple">
<dt>traj<span class="classifier">(N, n) array</span></dt><dd><p>The generated trajectories</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>To produce a trajectory of length N from an MSD of length N, we assume the
very last data point of the autocorrelation function to be identical to the
second to last.
Strictly speaking, only the ensemble of displacements is well-defined,
because this is the one we assume steady state for. For the actual
trajectories, we can add an arbitrary offset, and the reasonable thing to
do here depends on the process we are sampling. For purely diffusive
trajectories for example it makes sense to have them all start from zero,
since there is no steady state anyways. If however, we are sampling from an
MSD that plateaus at long times, we basically also have a steady state for
the trajectories and we can reasonably talk about the mean of a trajectory.
In that case of course it makes sense to keep this mean constant. The
option subtractMean does exactly this: if True, we subtract the mean from
all generated trajectories, i.e. fix the ensemble mean to zero.</p>
</dd></dl>

<dl class="function">
<dt id="tracklib.models.statgauss.dataset">
<code class="sig-prename descclassname">tracklib.models.statgauss.</code><code class="sig-name descname">dataset</code><span class="sig-paren">(</span><em class="sig-param">msd</em>, <em class="sig-param">N=2</em>, <em class="sig-param">Ts=None</em>, <em class="sig-param">d=3</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.models.statgauss.dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a dataset of MSD sampled trajectories.</p>
<dl class="simple">
<dt>msd<span class="classifier">1d numpy.ndarray</span></dt><dd><p>the MSD to sample from.</p>
</dd>
<dt>N<span class="classifier">integer</span></dt><dd><p>number of particles per trajectory
default: 2</p>
</dd>
<dt>Ts<span class="classifier">list of int</span></dt><dd><p>list of trajectory lengths, i.e. this determines number and length of
trajectories. Any None entry will be replaced by the maximum possible
value, len(msd). If there are values bigger than that, raises a
ValueError.
default: 100*[None]</p>
</dd>
<dt>d<span class="classifier">integer</span></dt><dd><p>spatial dimension of the trajectories to sample
default: 3</p>
</dd>
</dl>
<p>other kwargs are forwarded to util.sampleMSD()</p>
<p>A TaggedSet of trajectories (with only the trivial tag ‘_all’).</p>
</dd></dl>

<dl class="function">
<dt id="tracklib.models.statgauss.control">
<code class="sig-prename descclassname">tracklib.models.statgauss.</code><code class="sig-name descname">control</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">msd=None</em>, <em class="sig-param">setMean='copy'</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.models.statgauss.control" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a sister data set where each trajectory is sampled from a
stationary Gaussian process with MSD equal to the ensemble mean of the
given data set or the explicitly given MSD. Note generation from
experimental data (i.e. the ensemble mean) does not always work, because
that is noisy. Thus the option to provide a cleaned version.</p>
<p>The mean of each trajectory will be set to coincide with the mean of the
sister trajectory it is generated from.</p>
<dl class="simple">
<dt>dataset<span class="classifier">TaggedSet of Trajectory</span></dt><dd><p>the dataset to generate a control for</p>
</dd>
<dt>msd<span class="classifier">(T,) np.ndarray</span></dt><dd><p>the MSD to use for sampling. Note that this will be divided by
(#loci)x(#dimensions) before sampling scalar traces, matching the usual
notion of MSD of (e.g.) multidimensional trajectories.</p>
</dd>
</dl>
<p>A TaggedSet that’s an MSD generated sister data set to the input</p>
<p>Should this be merged/unified with MSDdataset?</p>
</dd></dl>

</div>
<div class="section" id="module-tracklib.models">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-tracklib.models" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">tracklib.models package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-tracklib.models.rouse">tracklib.models.rouse module</a></li>
<li><a class="reference internal" href="#module-tracklib.models.statgauss">tracklib.models.statgauss module</a></li>
<li><a class="reference internal" href="#module-tracklib.models">Module contents</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tracklib.models.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">tracklib 0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Simon Grosse-Holz.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.1.2.
    </div>
  </body>
</html>