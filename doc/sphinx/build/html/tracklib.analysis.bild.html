
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>tracklib.analysis.bild &#8212; tracklib 0.1 documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="tracklib.analysis.msdfit" href="tracklib.analysis.msdfit.html" />
    <link rel="prev" title="tracklib.analysis" href="tracklib.analysis.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tracklib.analysis.msdfit.html" title="tracklib.analysis.msdfit"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tracklib.analysis.html" title="tracklib.analysis"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">tracklib 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="tracklib.html" >tracklib</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="tracklib.analysis.html" accesskey="U">tracklib.analysis</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tracklib-analysis-bild">
<h1>tracklib.analysis.bild<a class="headerlink" href="#tracklib-analysis-bild" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#module-tracklib.analysis.bild.bild" id="id1">tracklib.analysis.bild.bild</a></p></li>
<li><p><a class="reference internal" href="#module-tracklib.analysis.bild.kebys" id="id2">tracklib.analysis.bild.kebys</a></p></li>
<li><p><a class="reference internal" href="#module-tracklib.analysis.bild.mcmc" id="id3">tracklib.analysis.bild.mcmc</a></p></li>
<li><p><a class="reference internal" href="#module-tracklib.analysis.bild.models" id="id4">tracklib.analysis.bild.models</a></p></li>
<li><p><a class="reference internal" href="#module-tracklib.analysis.bild.neda" id="id5">tracklib.analysis.bild.neda</a></p></li>
<li><p><a class="reference internal" href="#module-tracklib.analysis.bild.plot" id="id6">tracklib.analysis.bild.plot</a></p></li>
<li><p><a class="reference internal" href="#tracklib-analysis-bild-postproc" id="id7">tracklib.analysis.bild.postproc</a></p></li>
<li><p><a class="reference internal" href="#module-tracklib.analysis.bild.priors" id="id8">tracklib.analysis.bild.priors</a></p></li>
<li><p><a class="reference internal" href="#module-tracklib.analysis.bild.util" id="id9">tracklib.analysis.bild.util</a></p></li>
</ul>
</div>
<div class="section" id="module-tracklib.analysis.bild.bild">
<span id="tracklib-analysis-bild-bild"></span><h2><a class="toc-backref" href="#id1">tracklib.analysis.bild.bild</a><a class="headerlink" href="#module-tracklib.analysis.bild.bild" title="Permalink to this headline">¶</a></h2>
<p>Main module of the bild inference package</p>
<dl class="function">
<dt id="tracklib.analysis.bild.bild.main">
<code class="sig-prename descclassname">tracklib.analysis.bild.bild.</code><code class="sig-name descname">main</code><span class="sig-paren">(</span><em class="sig-param">traj</em>, <em class="sig-param">model</em>, <em class="sig-param">MCMCconfig</em>, <em class="sig-param">priorscheme=None</em>, <em class="sig-param">sampler=None</em>, <em class="sig-param">return_='nothing'</em>, <em class="sig-param">return_mcmcrun=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.bild.main" title="Permalink to this definition">¶</a></dt>
<dd><p>How to run this scheme on one trajectory</p>
</dd></dl>

</div>
<div class="section" id="module-tracklib.analysis.bild.kebys">
<span id="tracklib-analysis-bild-kebys"></span><h2><a class="toc-backref" href="#id2">tracklib.analysis.bild.kebys</a><a class="headerlink" href="#module-tracklib.analysis.bild.kebys" title="Permalink to this headline">¶</a></h2>
<p>Fixed-k Evidence by Sampling</p>
<dl class="simple">
<dt>Parametrize binary profiles as (s, theta) where</dt><dd><ul class="simple">
<li><p>Σs = 1, s_i &gt; 0</p></li>
<li><p>theta ∈ {0, 1}</p></li>
<li><p>s are interval lengths, as fraction of the whole trajectory. Thus it has k+1 values.</p></li>
</ul>
</dd>
</dl>
<dl class="function">
<dt id="tracklib.analysis.bild.kebys.st2profile">
<code class="sig-prename descclassname">tracklib.analysis.bild.kebys.</code><code class="sig-name descname">st2profile</code><span class="sig-paren">(</span><em class="sig-param">s</em>, <em class="sig-param">theta</em>, <em class="sig-param">traj</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.kebys.st2profile" title="Permalink to this definition">¶</a></dt>
<dd><p>s are interval lengths (as fraction of total trajectory length)</p>
</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.bild.kebys.dirichlet_methodofmoments">
<code class="sig-prename descclassname">tracklib.analysis.bild.kebys.</code><code class="sig-name descname">dirichlet_methodofmoments</code><span class="sig-paren">(</span><em class="sig-param">ss</em>, <em class="sig-param">normalized_weights</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.kebys.dirichlet_methodofmoments" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tracklib.analysis.bild.kebys.logL">
<code class="sig-prename descclassname">tracklib.analysis.bild.kebys.</code><code class="sig-name descname">logL</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.kebys.logL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tracklib.analysis.bild.kebys.calculate_logLs">
<code class="sig-prename descclassname">tracklib.analysis.bild.kebys.</code><code class="sig-name descname">calculate_logLs</code><span class="sig-paren">(</span><em class="sig-param">ss</em>, <em class="sig-param">thetas</em>, <em class="sig-param">traj</em>, <em class="sig-param">model</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.kebys.calculate_logLs" title="Permalink to this definition">¶</a></dt>
<dd><p>parallel-aware (ordered)</p>
</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.bild.kebys.proposal">
<code class="sig-prename descclassname">tracklib.analysis.bild.kebys.</code><code class="sig-name descname">proposal</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">m</em>, <em class="sig-param">s</em>, <em class="sig-param">theta0</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.kebys.proposal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tracklib.analysis.bild.kebys.sample_proposal">
<code class="sig-prename descclassname">tracklib.analysis.bild.kebys.</code><code class="sig-name descname">sample_proposal</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">m</em>, <em class="sig-param">N</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.kebys.sample_proposal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tracklib.analysis.bild.kebys.fit_proposal">
<code class="sig-prename descclassname">tracklib.analysis.bild.kebys.</code><code class="sig-name descname">fit_proposal</code><span class="sig-paren">(</span><em class="sig-param">ss</em>, <em class="sig-param">thetas</em>, <em class="sig-param">weights</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.kebys.fit_proposal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="tracklib.analysis.bild.kebys.FixedkSampler">
<em class="property">class </em><code class="sig-prename descclassname">tracklib.analysis.bild.kebys.</code><code class="sig-name descname">FixedkSampler</code><span class="sig-paren">(</span><em class="sig-param">traj</em>, <em class="sig-param">model</em>, <em class="sig-param">k</em>, <em class="sig-param">N=100</em>, <em class="sig-param">concentration_brake=0.01</em>, <em class="sig-param">polarization_brake=0.001</em>, <em class="sig-param">max_fev=20000</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.kebys.FixedkSampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="tracklib.analysis.bild.kebys.FixedkSampler.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.kebys.FixedkSampler.step" title="Permalink to this definition">¶</a></dt>
<dd><p>returns False if Sampler is exhausted, True otherwise</p>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.kebys.FixedkSampler.t_stat">
<code class="sig-name descname">t_stat</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.kebys.FixedkSampler.t_stat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.kebys.FixedkSampler.MLE_profile">
<code class="sig-name descname">MLE_profile</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.kebys.FixedkSampler.MLE_profile" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.bild.kebys.sample">
<code class="sig-prename descclassname">tracklib.analysis.bild.kebys.</code><code class="sig-name descname">sample</code><span class="sig-paren">(</span><em class="sig-param">traj</em>, <em class="sig-param">model</em>, <em class="sig-param">samples_per_step=100</em>, <em class="sig-param">init_runs=20</em>, <em class="sig-param">significant_separation_sem_fold=5</em>, <em class="sig-param">k_lookahead=2</em>, <em class="sig-param">k_max=20</em>, <em class="sig-param">sampler_kw={}</em>, <em class="sig-param">show_progress=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.kebys.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>uses calculate_logLs, which is parallel-aware (ordered)</p>
</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.bild.kebys.logLR_boundaries">
<code class="sig-prename descclassname">tracklib.analysis.bild.kebys.</code><code class="sig-name descname">logLR_boundaries</code><span class="sig-paren">(</span><em class="sig-param">profile</em>, <em class="sig-param">traj</em>, <em class="sig-param">model</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.kebys.logLR_boundaries" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tracklib.analysis.bild.kebys.optimize_boundary">
<code class="sig-prename descclassname">tracklib.analysis.bild.kebys.</code><code class="sig-name descname">optimize_boundary</code><span class="sig-paren">(</span><em class="sig-param">profile</em>, <em class="sig-param">traj</em>, <em class="sig-param">model</em>, <em class="sig-param">max_iteration=10000</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.kebys.optimize_boundary" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-tracklib.analysis.bild.mcmc">
<span id="tracklib-analysis-bild-mcmc"></span><h2><a class="toc-backref" href="#id3">tracklib.analysis.bild.mcmc</a><a class="headerlink" href="#module-tracklib.analysis.bild.mcmc" title="Permalink to this headline">¶</a></h2>
<p>The MCMC sampler used for inference</p>
<dl class="class">
<dt id="tracklib.analysis.bild.mcmc.PartScheme">
<em class="property">class </em><code class="sig-prename descclassname">tracklib.analysis.bild.mcmc.</code><code class="sig-name descname">PartScheme</code><span class="sig-paren">(</span><em class="sig-param">start_params</em>, <em class="sig-param">bounds</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.mcmc.PartScheme" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tracklib.analysis.bild.util.ParametricFamily" title="tracklib.analysis.bild.util.ParametricFamily"><code class="xref py py-class docutils literal notranslate"><span class="pre">tracklib.analysis.bild.util.ParametricFamily</span></code></a></p>
<p>“Beefy ParametricFamily” for MCMC sampling
Similar to the old MCMCScheme
Note that here we assume that <code class="docutils literal notranslate"><span class="pre">get()</span></code> takes a single tuple as argument,
instead of individual parameters. This makes handling in the MCMC easier.
Also here the idea is to subclass and implement members, whereas for
ParametricFamily we would instantiate and simply overwrite the <code class="xref any docutils literal notranslate"><span class="pre">get</span></code>
attribute.</p>
<dl class="method">
<dt id="tracklib.analysis.bild.mcmc.PartScheme.get">
<code class="sig-name descname">get</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.mcmc.PartScheme.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate an object from the given parameters</p>
<p>This function should be overwritten upon instantiation</p>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.mcmc.PartScheme.stepping_probability">
<em class="property">abstract </em><code class="sig-name descname">stepping_probability</code><span class="sig-paren">(</span><em class="sig-param">params_from</em>, <em class="sig-param">params_to</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.mcmc.PartScheme.stepping_probability" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.mcmc.PartScheme.gen_proposal_sample_from">
<em class="property">abstract </em><code class="sig-name descname">gen_proposal_sample_from</code><span class="sig-paren">(</span><em class="sig-param">params=None</em>, <em class="sig-param">nSample=1</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.mcmc.PartScheme.gen_proposal_sample_from" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="tracklib.analysis.bild.mcmc.FixedScheme">
<em class="property">class </em><code class="sig-prename descclassname">tracklib.analysis.bild.mcmc.</code><code class="sig-name descname">FixedScheme</code><span class="sig-paren">(</span><em class="sig-param">family</em>, <em class="sig-param">*fixed_args</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.mcmc.FixedScheme" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tracklib.analysis.bild.mcmc.PartScheme" title="tracklib.analysis.bild.mcmc.PartScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">tracklib.analysis.bild.mcmc.PartScheme</span></code></a></p>
<dl class="method">
<dt id="tracklib.analysis.bild.mcmc.FixedScheme.get">
<code class="sig-name descname">get</code><span class="sig-paren">(</span><em class="sig-param">*args</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.mcmc.FixedScheme.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate an object from the given parameters</p>
<p>This function should be overwritten upon instantiation</p>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.mcmc.FixedScheme.stepping_probability">
<code class="sig-name descname">stepping_probability</code><span class="sig-paren">(</span><em class="sig-param">params_from</em>, <em class="sig-param">params_to</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.mcmc.FixedScheme.stepping_probability" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.mcmc.FixedScheme.gen_proposal_sample_from">
<code class="sig-name descname">gen_proposal_sample_from</code><span class="sig-paren">(</span><em class="sig-param">params=None</em>, <em class="sig-param">nSample=1</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.mcmc.FixedScheme.gen_proposal_sample_from" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="tracklib.analysis.bild.mcmc.GeometricPriorScheme">
<em class="property">class </em><code class="sig-prename descclassname">tracklib.analysis.bild.mcmc.</code><code class="sig-name descname">GeometricPriorScheme</code><span class="sig-paren">(</span><em class="sig-param">nStates=2</em>, <em class="sig-param">stepsize=0.1</em>, <em class="sig-param">initial_logq=-1e-05</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.mcmc.GeometricPriorScheme" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tracklib.analysis.bild.mcmc.PartScheme" title="tracklib.analysis.bild.mcmc.PartScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">tracklib.analysis.bild.mcmc.PartScheme</span></code></a></p>
<dl class="method">
<dt id="tracklib.analysis.bild.mcmc.GeometricPriorScheme.get">
<code class="sig-name descname">get</code><span class="sig-paren">(</span><em class="sig-param">logq</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.mcmc.GeometricPriorScheme.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate an object from the given parameters</p>
<p>This function should be overwritten upon instantiation</p>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.mcmc.GeometricPriorScheme.stepping_probability">
<code class="sig-name descname">stepping_probability</code><span class="sig-paren">(</span><em class="sig-param">logq_from</em>, <em class="sig-param">logq_to</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.mcmc.GeometricPriorScheme.stepping_probability" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.mcmc.GeometricPriorScheme.gen_proposal_sample_from">
<code class="sig-name descname">gen_proposal_sample_from</code><span class="sig-paren">(</span><em class="sig-param">params=None</em>, <em class="sig-param">nSample=1</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.mcmc.GeometricPriorScheme.gen_proposal_sample_from" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="tracklib.analysis.bild.mcmc.FullMCMC">
<em class="property">class </em><code class="sig-prename descclassname">tracklib.analysis.bild.mcmc.</code><code class="sig-name descname">FullMCMC</code><span class="sig-paren">(</span><em class="sig-param">move_weights=(0.1</em>, <em class="sig-param">1</em>, <em class="sig-param">1)</em>, <em class="sig-param">alpha=2</em>, <em class="sig-param">initialize_from='model'</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.mcmc.FullMCMC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="tracklib.util.html#tracklib.util.mcmc.Sampler" title="tracklib.util.mcmc.Sampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">tracklib.util.mcmc.Sampler</span></code></a></p>
<p>move_weights are ‘cluster flip’, ‘boundary move’, ‘new_interval’</p>
<dl class="method">
<dt id="tracklib.analysis.bild.mcmc.FullMCMC.setup">
<code class="sig-name descname">setup</code><span class="sig-paren">(</span><em class="sig-param">traj</em>, <em class="sig-param">model</em>, <em class="sig-param">priorscheme</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.mcmc.FullMCMC.setup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.mcmc.FullMCMC.configure">
<code class="sig-name descname">configure</code><span class="sig-paren">(</span><em class="sig-param">min_approaches_to_best_sample=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.mcmc.FullMCMC.configure" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the configuration of the sampler.</p>
<p>Note that after calling this function once, you can also access single
configuration entries via the attribute <a class="reference internal" href="tracklib.util.html#tracklib.util.mcmc.Sampler.config" title="tracklib.util.mcmc.Sampler.config"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">config</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iterations</strong> (<em>int</em>) – how many MCMC iterations to run total</p></li>
<li><p><strong>burn_in</strong> (<em>int</em>) – how many steps to discard at the beginning</p></li>
<li><p><strong>log_every</strong> (<em>int</em>) – print a status line every … steps. Set to <code class="docutils literal notranslate"><span class="pre">-1</span></code> (default) to
disable status lines.</p></li>
<li><p><strong>check_stopping_every</strong> (<em>int</em>) – how often to call the <a class="reference internal" href="#tracklib.analysis.bild.mcmc.FullMCMC.callback_stopping" title="tracklib.analysis.bild.mcmc.FullMCMC.callback_stopping"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">callback_stopping</span></code></a>. Set to <code class="docutils literal notranslate"><span class="pre">-1</span></code> (default)
to never check.</p></li>
<li><p><strong>show_progress</strong> (<em>bool</em>) – whether to show a progress bar using <code class="xref any docutils literal notranslate"><span class="pre">tqdm</span></code></p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.bild.mcmc.FullMCMC.run" title="tracklib.analysis.bild.mcmc.FullMCMC.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.mcmc.FullMCMC.callback_stopping">
<code class="sig-name descname">callback_stopping</code><span class="sig-paren">(</span><em class="sig-param">myrun</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.mcmc.FullMCMC.callback_stopping" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback to enable early stopping</p>
<p>This function will be called at well-defined intervals to check whether
sampling should abort. Judgement is to be made based on the data so
far, which is handed over as the <code class="xref any docutils literal notranslate"><span class="pre">myrun</span></code> argument. This is an
<a class="reference internal" href="tracklib.analysis.neda.html#tracklib.analysis.neda.mcmc.MCMCRun" title="tracklib.analysis.neda.mcmc.MCMCRun"><code class="xref any py py-class docutils literal notranslate"><span class="pre">MCMCRun</span></code></a> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>myrun</strong> (<a class="reference internal" href="tracklib.analysis.neda.html#tracklib.analysis.neda.mcmc.MCMCRun" title="tracklib.analysis.neda.mcmc.MCMCRun"><em>MCMCRun</em></a>) – the data generated so far</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>stop</strong> (<em>bool</em>) – should be <code class="docutils literal notranslate"><span class="pre">True</span></code> if the sampling is to stop, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.mcmc.FullMCMC.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.mcmc.FullMCMC.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the sampling scheme</p>
<p>Remember to run <a class="reference internal" href="#tracklib.analysis.bild.mcmc.FullMCMC.configure" title="tracklib.analysis.bild.mcmc.FullMCMC.configure"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">configure</span></code></a> before this.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>initial_values</strong> (<em>&lt;user-specified parameter structure&gt;</em>) – the initial values for the sampling scheme</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>MCMCRun</em> – the output data of the run. This is essentially a wrapper class for
an array of likelihoods and the associated samples. Plus some
convenience functions.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.bild.mcmc.FullMCMC.configure" title="tracklib.analysis.bild.mcmc.FullMCMC.configure"><code class="xref py py-meth docutils literal notranslate"><span class="pre">configure()</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>The returned <a class="reference internal" href="tracklib.analysis.neda.html#tracklib.analysis.neda.mcmc.MCMCRun" title="tracklib.analysis.neda.mcmc.MCMCRun"><code class="xref any py py-class docutils literal notranslate"><span class="pre">MCMCRun</span></code></a> contains likelihoods for all steps starting at
initialization, while the list of sampled parameters starts only after
the burn-in period.</p>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.mcmc.FullMCMC.logL">
<code class="sig-name descname">logL</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.mcmc.FullMCMC.logL" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate log-likelihood of the given parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<em>&lt;user-specified parameter structure&gt;</em>) – the parameters to use</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float</em> – the log-likelihood for the given parameters.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.bild.mcmc.FullMCMC.propose_update" title="tracklib.analysis.bild.mcmc.FullMCMC.propose_update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">propose_update()</span></code></a>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">callback_logging()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.mcmc.FullMCMC.propose_update">
<code class="sig-name descname">propose_update</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.mcmc.FullMCMC.propose_update" title="Permalink to this definition">¶</a></dt>
<dd><p>Propose an update step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<em>&lt;user-specified parameter structure&gt;</em>) – the current parameters</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>proposed_values</strong> (<em>&lt;user-specified parameter structure&gt;</em>) – the proposed new parameters</p></li>
<li><p><strong>logp_forward</strong> (<em>float</em>) – (log of the) probability of proposing these values from the current
ones</p></li>
<li><p><strong>logp_backward</strong> (<em>float</em>) – (log of the) probability of proposing the current values from the
proposed ones</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.bild.mcmc.FullMCMC.logL" title="tracklib.analysis.bild.mcmc.FullMCMC.logL"><code class="xref py py-meth docutils literal notranslate"><span class="pre">logL()</span></code></a>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">callback_logging()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.mcmc.FullMCMC.stepping_probability">
<code class="sig-name descname">stepping_probability</code><span class="sig-paren">(</span><em class="sig-param">params_from</em>, <em class="sig-param">params_to</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.mcmc.FullMCMC.stepping_probability" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.mcmc.FullMCMC.gen_proposal_sample_from">
<code class="sig-name descname">gen_proposal_sample_from</code><span class="sig-paren">(</span><em class="sig-param">params</em>, <em class="sig-param">nSample=1</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.mcmc.FullMCMC.gen_proposal_sample_from" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.mcmc.FullMCMC.profile_stepping_probability">
<code class="sig-name descname">profile_stepping_probability</code><span class="sig-paren">(</span><em class="sig-param">profile_from</em>, <em class="sig-param">profile_to</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.mcmc.FullMCMC.profile_stepping_probability" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.mcmc.FullMCMC.profile_gen_proposal_sample_from">
<code class="sig-name descname">profile_gen_proposal_sample_from</code><span class="sig-paren">(</span><em class="sig-param">profile</em>, <em class="sig-param">nSample=1</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.mcmc.FullMCMC.profile_gen_proposal_sample_from" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-tracklib.analysis.bild.models">
<span id="tracklib-analysis-bild-models"></span><h2><a class="toc-backref" href="#id4">tracklib.analysis.bild.models</a><a class="headerlink" href="#module-tracklib.analysis.bild.models" title="Permalink to this headline">¶</a></h2>
<p>The inference models, and the interface they have to conform to.</p>
<dl class="class">
<dt id="tracklib.analysis.bild.models.MultiStateModel">
<em class="property">class </em><code class="sig-prename descclassname">tracklib.analysis.bild.models.</code><code class="sig-name descname">MultiStateModel</code><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Abstract base class for inference models</p>
<p>The most important capability of any model is the likelihood function
<a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel.logL" title="tracklib.analysis.bild.models.MultiStateModel.logL"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">logL</span></code></a> for a combination of <a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loopingprofile</span></code></a> and <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>. Furthermore, a
model should provide an initial guess for a good <a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loopingprofile</span></code></a>.</p>
<p>The method <a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel.trajectory_from_loopingprofile" title="tracklib.analysis.bild.models.MultiStateModel.trajectory_from_loopingprofile"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">trajectory_from_loopingprofile</span></code></a> is considered an optional part of
the interface, since it is not important to the inference, but might come
in handy when working with a <a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel" title="tracklib.analysis.bild.models.MultiStateModel"><code class="xref any py py-class docutils literal notranslate"><span class="pre">MultiStateModel</span></code></a>. So it is recommended but not
required.</p>
<dl class="method">
<dt id="tracklib.analysis.bild.models.MultiStateModel.nStates">
<em class="property">property </em><code class="sig-name descname">nStates</code><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateModel.nStates" title="Permalink to this definition">¶</a></dt>
<dd><p>How many internal states does this model have?</p>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.MultiStateModel.d">
<em class="property">property </em><code class="sig-name descname">d</code><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateModel.d" title="Permalink to this definition">¶</a></dt>
<dd><p>Spatial dimension</p>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.MultiStateModel.initial_loopingprofile">
<code class="sig-name descname">initial_loopingprofile</code><span class="sig-paren">(</span><em class="sig-param">traj</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateModel.initial_loopingprofile" title="Permalink to this definition">¶</a></dt>
<dd><p>Give a quick guess for a good <a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loopingprofile</span></code></a> for a <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>.</p>
<p>The default implementation gives a random <a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loopingprofile</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>traj</strong> (<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><em>Trajectory</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Loopingprofile</em></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.MultiStateModel.logL">
<em class="property">abstract </em><code class="sig-name descname">logL</code><span class="sig-paren">(</span><em class="sig-param">loopingprofile</em>, <em class="sig-param">traj</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateModel.logL" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate (log-)likelihood for (<a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loopingprofile</span></code></a>, <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>) pair.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loopingprofile</strong> (<a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><em>Loopingprofile</em></a>) – </p></li>
<li><p><strong>traj</strong> (<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><em>Trajectory</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float</em> – log-likelihood associated with the inputs</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.MultiStateModel.trajectory_from_loopingprofile">
<code class="sig-name descname">trajectory_from_loopingprofile</code><span class="sig-paren">(</span><em class="sig-param">loopingprofile</em>, <em class="sig-param">localization_error</em>, <em class="sig-param">missing_frames</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateModel.trajectory_from_loopingprofile" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a> from this <a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel" title="tracklib.analysis.bild.models.MultiStateModel"><code class="xref any py py-class docutils literal notranslate"><span class="pre">MultiStateModel</span></code></a> and the given <a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loopingprofile</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loopingprofile</strong> (<a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><em>Loopingprofile</em></a>) – </p></li>
<li><p><strong>localization_error</strong> (<em>float</em><em>, </em><em>optional</em>) – how much Gaussian noise to add to the trajectory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Trajectory</em></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tracklib.analysis.bild.models.MultiStateRouse">
<em class="property">class </em><code class="sig-prename descclassname">tracklib.analysis.bild.models.</code><code class="sig-name descname">MultiStateRouse</code><span class="sig-paren">(</span><em class="sig-param">N</em>, <em class="sig-param">D</em>, <em class="sig-param">k</em>, <em class="sig-param">d=3</em>, <em class="sig-param">looppositions=((0</em>, <em class="sig-param">0)</em>, <em class="sig-param">(0</em>, <em class="sig-param">-1))</em>, <em class="sig-param">measurement='end2end'</em>, <em class="sig-param">localization_error=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateRouse" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel" title="tracklib.analysis.bild.models.MultiStateModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">tracklib.analysis.bild.models.MultiStateModel</span></code></a></p>
<p>A multi-state Rouse model</p>
<p>This inference model uses a given number of <a class="reference internal" href="tracklib.models.html#tracklib.models.rouse.Model" title="tracklib.models.rouse.Model"><code class="xref any py py-class docutils literal notranslate"><span class="pre">rouse.Model</span></code></a> instances to
choose from for each propagation interval. In the default use case this
switches between a looped and unlooped model, but it could be way more
general than that, e.g. incorporating different looped states, loop
positions, numbers of loops, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N</strong> (<em>int</em>) – number of monomers</p></li>
<li><p><strong>k</strong> (<em>D</em><em>,</em>) – Rouse parameters: 1d diffusion constant of free monomers and backbone
spring constant</p></li>
<li><p><strong>d</strong> (<em>int</em><em>, </em><em>optional</em>) – spatial dimension</p></li>
<li><p><strong>looppositions</strong> (<em>list of 2-tuples of int</em><em>, </em><em>optional</em>) – list of positions of the extra bond. For each entry, a new
<a class="reference internal" href="tracklib.models.html#tracklib.models.rouse.Model" title="tracklib.models.rouse.Model"><code class="xref any py py-class docutils literal notranslate"><span class="pre">rouse.Model</span></code></a> instance will be set up. Remember to include an unlooped
model (if wanted) by including a position like <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">0)</span></code>. Each entry
can alternatively be a 3-tuple, where the 3rd entry then specifies the
strength of the extra bond relative to the backbone, e.g. <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">5,</span>
<span class="pre">0.5)</span></code> introduces an additional bond between monomers 0 and 5 with
strength <code class="docutils literal notranslate"><span class="pre">0.5*k</span></code>. Finally, instead of a single tuple, each bond
specification can be a list of such tuples if multiple added bonds are
needed.</p></li>
<li><p><strong>measurement</strong> (<em>&quot;end2end&quot;</em><em> or </em><em>(</em><em>N</em><em>,</em><em>) </em><em>np.ndarray</em>) – which distance to measure. The default setting “end2end” is equivalent
to specifying a vector <code class="docutils literal notranslate"><span class="pre">np.array([-1,</span> <span class="pre">0,</span> <span class="pre">...,</span> <span class="pre">0,</span> <span class="pre">1])</span></code>, i.e. measuring
the distance from the first to the last monomer.</p></li>
<li><p><strong>localization_error</strong> (<em>float</em><em> or </em><em>np.array</em><em>, </em><em>optional</em>) – a global value for the localization error. By default, we use the value
stored in <code class="docutils literal notranslate"><span class="pre">traj.meta['localization_error']</span></code>, which allows
trajectory-wise specification of error. But for example for fitting it
might be useful to have one global setting for localization error, at
which point it becomes part of the model. Give a scalar value to have
the same error apply to all dimensions</p></li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt id="tracklib.analysis.bild.models.MultiStateRouse.models">
<code class="sig-name descname">models</code><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateRouse.models" title="Permalink to this definition">¶</a></dt>
<dd><p>the models used for inference</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of <a class="reference internal" href="tracklib.models.html#tracklib.models.rouse.Model" title="tracklib.models.rouse.Model"><code class="xref any py py-class docutils literal notranslate"><span class="pre">rouse.Model</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tracklib.analysis.bild.models.MultiStateRouse.measurement">
<code class="sig-name descname">measurement</code><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateRouse.measurement" title="Permalink to this definition">¶</a></dt>
<dd><p>the measurement vector for this model</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>(N,) np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tracklib.analysis.bild.models.MultiStateRouse.localization_error">
<code class="sig-name descname">localization_error</code><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateRouse.localization_error" title="Permalink to this definition">¶</a></dt>
<dd><p>if <code class="docutils literal notranslate"><span class="pre">None</span></code>, use <code class="docutils literal notranslate"><span class="pre">traj.meta['localization_error']</span></code> for each
trajectory <code class="docutils literal notranslate"><span class="pre">traj</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array or None</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Notes</p>
<p>The <a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateRouse.initial_loopingprofile" title="tracklib.analysis.bild.models.MultiStateRouse.initial_loopingprofile"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">initial_loopingprofile</span></code></a> for this <a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel" title="tracklib.analysis.bild.models.MultiStateModel"><code class="xref any py py-class docutils literal notranslate"><span class="pre">MultiStateModel</span></code></a> is the MLE assuming time scale
separation. I.e. we calculate the timepoint-wise MLE using the exact steady
state distributions of each model.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel" title="tracklib.analysis.bild.models.MultiStateModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiStateModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">rouse.Model</span></code></p>
</div>
<dl class="method">
<dt id="tracklib.analysis.bild.models.MultiStateRouse.nStates">
<em class="property">property </em><code class="sig-name descname">nStates</code><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateRouse.nStates" title="Permalink to this definition">¶</a></dt>
<dd><p>How many internal states does this model have?</p>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.MultiStateRouse.d">
<em class="property">property </em><code class="sig-name descname">d</code><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateRouse.d" title="Permalink to this definition">¶</a></dt>
<dd><p>Spatial dimension</p>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.MultiStateRouse.initial_loopingprofile">
<code class="sig-name descname">initial_loopingprofile</code><span class="sig-paren">(</span><em class="sig-param">traj</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateRouse.initial_loopingprofile" title="Permalink to this definition">¶</a></dt>
<dd><p>Give a quick guess for a good <a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loopingprofile</span></code></a> for a <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>.</p>
<p>The default implementation gives a random <a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loopingprofile</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>traj</strong> (<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><em>Trajectory</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Loopingprofile</em></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.MultiStateRouse.logL">
<code class="sig-name descname">logL</code><span class="sig-paren">(</span><em class="sig-param">profile</em>, <em class="sig-param">traj</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateRouse.logL" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate (log-)likelihood for (<a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loopingprofile</span></code></a>, <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>) pair.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loopingprofile</strong> (<a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><em>Loopingprofile</em></a>) – </p></li>
<li><p><strong>traj</strong> (<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><em>Trajectory</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float</em> – log-likelihood associated with the inputs</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.MultiStateRouse.trajectory_from_loopingprofile">
<code class="sig-name descname">trajectory_from_loopingprofile</code><span class="sig-paren">(</span><em class="sig-param">profile</em>, <em class="sig-param">localization_error=None</em>, <em class="sig-param">missing_frames=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateRouse.trajectory_from_loopingprofile" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a> from this <a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel" title="tracklib.analysis.bild.models.MultiStateModel"><code class="xref any py py-class docutils literal notranslate"><span class="pre">MultiStateModel</span></code></a> and the given <a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loopingprofile</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loopingprofile</strong> (<a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><em>Loopingprofile</em></a>) – </p></li>
<li><p><strong>localization_error</strong> (<em>float</em><em>, </em><em>optional</em>) – how much Gaussian noise to add to the trajectory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Trajectory</em></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.MultiStateRouse.toFactorized">
<code class="sig-name descname">toFactorized</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateRouse.toFactorized" title="Permalink to this definition">¶</a></dt>
<dd><p>Give the corresponding <a class="reference internal" href="#tracklib.analysis.bild.models.FactorizedModel" title="tracklib.analysis.bild.models.FactorizedModel"><code class="xref any py py-class docutils literal notranslate"><span class="pre">FactorizedModel</span></code></a></p>
<p>This is the model that simply calculates likelihoods from the steady
state probabilities of each of the individual states.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>FactorizedModel</em></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tracklib.analysis.bild.models.FactorizedModel">
<em class="property">class </em><code class="sig-prename descclassname">tracklib.analysis.bild.models.</code><code class="sig-name descname">FactorizedModel</code><span class="sig-paren">(</span><em class="sig-param">distributions</em>, <em class="sig-param">d=3</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.models.FactorizedModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel" title="tracklib.analysis.bild.models.MultiStateModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">tracklib.analysis.bild.models.MultiStateModel</span></code></a></p>
<p>A simplified model, assuming time scale separation</p>
<p>This model assumes that each point is sampled from one of a given list of
distributions, where there is no correlation between the choice of
distribution for each point. It runs significantly faster than the full
<a class="reference internal" href="tracklib.analysis.neda.html#tracklib.analysis.neda.models.RouseModel" title="tracklib.analysis.neda.models.RouseModel"><code class="xref any py py-class docutils literal notranslate"><span class="pre">RouseModel</span></code></a>, but is of course inaccurate if the Rouse time is longer or
comparable to the frame rate of the recorded trajectories.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>distributions</strong> (<em>list of distribution objects</em>) – these will usually be <code class="docutils literal notranslate"><span class="pre">scipy.stats.rv_continuous</span></code> objects (e.g.
Maxwell), but can be pretty arbitrary. The only function they have to
provide is <code class="docutils literal notranslate"><span class="pre">logpdf()</span></code>, which should take a scalar or vector of
distance values and return a corresponding number of outputs. If you
plan on using <a class="reference internal" href="tracklib.analysis.neda.html#tracklib.analysis.neda.models.Model.trajectory_from_loopingtrace" title="tracklib.analysis.neda.models.Model.trajectory_from_loopingtrace"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">trajectory_from_loopingtrace</span></code></a>, the distributions should
also have an <code class="docutils literal notranslate"><span class="pre">rvs()</span></code> method for sampling.</p>
</dd>
</dl>
<dl class="attribute">
<dt id="tracklib.analysis.bild.models.FactorizedModel.distributions">
<code class="sig-name descname">distributions</code><a class="headerlink" href="#tracklib.analysis.bild.models.FactorizedModel.distributions" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of distribution objects</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Notes</p>
<p>This being a heuristical model, we assume that the localization error is
already incorporated in the <code class="xref any docutils literal notranslate"><span class="pre">distributions</span></code>, as would be the case if they
come from experimental data. Therefore, this class ignores the
<code class="docutils literal notranslate"><span class="pre">meta['localization_error']</span></code> field of <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>.</p>
<p>Instances of this class memoize trajectories they have seen before. To
reset the memoization, you can either reinstantiate or clear the cache
manually:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">FactorizedModel</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">distributions</span><span class="p">)</span>
<span class="gp">... </span><span class="n">model</span><span class="o">.</span><span class="n">clear_memo</span><span class="p">()</span>
</pre></div>
</div>
<p>If using <code class="docutils literal notranslate"><span class="pre">scipy.stats.maxwell</span></code>, make sure to use it correctly, i.e. you
have to specify <code class="docutils literal notranslate"><span class="pre">scale=...</span></code>. Writing <code class="docutils literal notranslate"><span class="pre">scipy.stats.maxwell(5)</span></code> instead
of <code class="docutils literal notranslate"><span class="pre">scipy.stats.maxwell(scale=5)</span></code> shifts the distribution instead of
scaling it and leads to <code class="docutils literal notranslate"><span class="pre">-inf</span></code> values in the likelihood, which then screw
up the MCMC. The classic error to get for this is <code class="docutils literal notranslate"><span class="pre">invalid</span> <span class="pre">value</span>
<span class="pre">encountered</span> <span class="pre">in</span> <span class="pre">double_scalars</span></code>. This is caused by <code class="docutils literal notranslate"><span class="pre">new_logL</span> <span class="pre">-</span> <span class="pre">cur_logL</span></code>
reading <code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">inf</span> <span class="pre">+</span> <span class="pre">inf</span></code> at the first MCMC iteration, if <a class="reference internal" href="#tracklib.analysis.bild.models.FactorizedModel.logL" title="tracklib.analysis.bild.models.FactorizedModel.logL"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">logL</span></code></a> returns
<code class="docutils literal notranslate"><span class="pre">-inf</span></code>.</p>
<p class="rubric">Examples</p>
<p>Experimentally measured distributions can be used straightforwardly using
<code class="docutils literal notranslate"><span class="pre">scipy.stats.gaussian_kde</span></code>: assuming we have measured ensembles of
distances <code class="docutils literal notranslate"><span class="pre">dists_i</span></code> for reference states <code class="docutils literal notranslate"><span class="pre">i</span></code>, we can use</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">FactorizedModel</span><span class="p">([</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">gaussian_kde</span><span class="p">(</span><span class="n">dists_0</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">gaussian_kde</span><span class="p">(</span><span class="n">dists_1</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">gaussian_kde</span><span class="p">(</span><span class="n">dists_1</span><span class="p">)])</span>
</pre></div>
</div>
<dl class="method">
<dt id="tracklib.analysis.bild.models.FactorizedModel.nStates">
<em class="property">property </em><code class="sig-name descname">nStates</code><a class="headerlink" href="#tracklib.analysis.bild.models.FactorizedModel.nStates" title="Permalink to this definition">¶</a></dt>
<dd><p>How many internal states does this model have?</p>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.FactorizedModel.d">
<em class="property">property </em><code class="sig-name descname">d</code><a class="headerlink" href="#tracklib.analysis.bild.models.FactorizedModel.d" title="Permalink to this definition">¶</a></dt>
<dd><p>Spatial dimension</p>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.FactorizedModel.clear_memo">
<code class="sig-name descname">clear_memo</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.models.FactorizedModel.clear_memo" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear the memoization cache</p>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.FactorizedModel.initial_loopingprofile">
<code class="sig-name descname">initial_loopingprofile</code><span class="sig-paren">(</span><em class="sig-param">traj</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.models.FactorizedModel.initial_loopingprofile" title="Permalink to this definition">¶</a></dt>
<dd><p>Give a quick guess for a good <a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loopingprofile</span></code></a> for a <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>.</p>
<p>The default implementation gives a random <a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loopingprofile</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>traj</strong> (<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><em>Trajectory</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Loopingprofile</em></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.FactorizedModel.logL">
<code class="sig-name descname">logL</code><span class="sig-paren">(</span><em class="sig-param">profile</em>, <em class="sig-param">traj</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.models.FactorizedModel.logL" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate (log-)likelihood for (<a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loopingprofile</span></code></a>, <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>) pair.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loopingprofile</strong> (<a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><em>Loopingprofile</em></a>) – </p></li>
<li><p><strong>traj</strong> (<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><em>Trajectory</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float</em> – log-likelihood associated with the inputs</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.FactorizedModel.trajectory_from_loopingprofile">
<code class="sig-name descname">trajectory_from_loopingprofile</code><span class="sig-paren">(</span><em class="sig-param">profile</em>, <em class="sig-param">localization_error=0.0</em>, <em class="sig-param">missing_frames=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.models.FactorizedModel.trajectory_from_loopingprofile" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a> from this <a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel" title="tracklib.analysis.bild.models.MultiStateModel"><code class="xref any py py-class docutils literal notranslate"><span class="pre">MultiStateModel</span></code></a> and the given <a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loopingprofile</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loopingprofile</strong> (<a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><em>Loopingprofile</em></a>) – </p></li>
<li><p><strong>localization_error</strong> (<em>float</em><em>, </em><em>optional</em>) – how much Gaussian noise to add to the trajectory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Trajectory</em></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.bild.models.fit">
<code class="sig-prename descclassname">tracklib.analysis.bild.models.</code><code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">modelfamily</em>, <em class="sig-param">show_progress=False</em>, <em class="sig-param">map_function=&lt;class 'map'&gt;</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.models.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the best fit model to a calibration dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>TaggedSet of Trajectory</em>) – the calibration data. Each <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a> should have a <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory.meta" title="tracklib.trajectory.Trajectory.meta"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">meta</span></code></a> entry <code class="docutils literal notranslate"><span class="pre">'loopingtrace'</span></code> indicating the true/assumed
<a class="reference internal" href="tracklib.analysis.neda.html#tracklib.analysis.neda.util.Loopingtrace" title="tracklib.analysis.neda.util.Loopingtrace"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loopingtrace</span></code></a> for this trajectory.</p></li>
<li><p><strong>modelfamily</strong> (<em>ParametricFamily of Models</em>) – the family of models to consider.</p></li>
<li><p><strong>show_progress</strong> (<em>bool</em><em>, </em><em>optional</em>) – set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to get progress info. Note that since we do not know
how many iterations we need for convergence, there is no ETA, just
elapsed time.</p></li>
<li><p><strong>map_function</strong> (<em>map-like callable</em>) – a function to replace the built-in <code class="docutils literal notranslate"><span class="pre">map()</span></code>, e.g. with a parallel
version. Will be used as
<code class="docutils literal notranslate"><span class="pre">np.sum(list(map_function(likelihood_given_parameters,</span> <span class="pre">data)))</span></code>, i.e.
order does not matter. <code class="docutils literal notranslate"><span class="pre">multiprocessing.Pool.imap_unordered</span></code> would be
a good go-to.</p></li>
<li><p><strong>kwargs</strong> (<em>kwargs</em>) – will be forwarded to <code class="xref any docutils literal notranslate"><span class="pre">scipy.optimize.minimize</span></code>. We use the defaults
<code class="docutils literal notranslate"><span class="pre">method='L-BFGS-B'</span></code>, <code class="docutils literal notranslate"><span class="pre">maxfun=300</span></code>, <code class="docutils literal notranslate"><span class="pre">ftol=1e-5</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>res</strong> (<em>fitresult</em>) – the structure returned by <code class="xref any docutils literal notranslate"><span class="pre">scipy.optimize.minimize</span></code>. The best fit
parameters are <code class="docutils literal notranslate"><span class="pre">res.x</span></code>, while their covariance matrix can be obtained
as <code class="docutils literal notranslate"><span class="pre">res.hess_inv.todens()</span></code>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>A good measure for relative uncertainty of the estimate is given by
<code class="docutils literal notranslate"><span class="pre">(√det(Σ)</span> <span class="pre">/</span> <span class="pre">Π(x))^(1/n)</span></code>, i.e. the major axes of the covariance ellipsoid
over the point estimates, normalized by the dimensionality:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">neda</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">modelfam</span><span class="p">)</span>
<span class="gp">... </span><span class="n">relative_uncertainty</span> <span class="o">=</span> <span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hess_inv</span><span class="o">.</span><span class="n">todense</span><span class="p">()))</span>     <span class="o">...</span>                        <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">modelfam</span><span class="o">.</span><span class="n">nParams</span><span class="p">)</span>
</pre></div>
</div>
<p>The function being minimized here is the negative log-likelihood of the
data set, given parameters to the <code class="xref any docutils literal notranslate"><span class="pre">modelfamily</span></code>. Specifically, this
function is</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">minimization_target</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">mappable</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">_neg_logL_traj</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">modelfamily</span><span class="p">(</span><span class="o">*</span><span class="n">params</span><span class="p">))</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nansum</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">map_function</span><span class="p">(</span><span class="n">mappable</span><span class="p">,</span> <span class="n">data</span><span class="p">)))</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>ParametricFamily</p>
<dl class="simple">
<dt><strong>Troubleshooting</strong></dt><dd><ul class="simple">
<li><p>make sure that the magnitude of parameter values is around one. The
minimizer (see <code class="xref any docutils literal notranslate"><span class="pre">scipy.optimize.minimize</span></code>) defaults to a fixed step
gradient descent, which is useless if parameters are orders of magnitude
bigger than 1. You can also try to play with the minimizer’s options to
make it use an adaptive step size.</p></li>
<li><p>make sure units match up. A common mistake is to have a unit mismatch
between localization error and trajectories (e.g. one in μm and the
other in nm). If the localization error is too big (here by a factor of
1000), the fit for <code class="xref any docutils literal notranslate"><span class="pre">D</span></code> will converge to zero (i.e. <code class="docutils literal notranslate"><span class="pre">1e-10</span></code>).</p></li>
<li><p>the <code class="docutils literal notranslate"><span class="pre">'hess_inv'</span></code> field returned with <code class="docutils literal notranslate"><span class="pre">method='L-BFGS-B'</span></code> might not
be super reliable, even if the point estimate is pretty good. Check
initial conditions when using this.</p></li>
</ul>
</dd>
</dl>
</div>
</dd></dl>

</div>
<div class="section" id="module-tracklib.analysis.bild.neda">
<span id="tracklib-analysis-bild-neda"></span><h2><a class="toc-backref" href="#id5">tracklib.analysis.bild.neda</a><a class="headerlink" href="#module-tracklib.analysis.bild.neda" title="Permalink to this headline">¶</a></h2>
<p>Reimplement the evidence based scheme</p>
<dl class="class">
<dt id="tracklib.analysis.bild.neda.Environment">
<em class="property">class </em><code class="sig-prename descclassname">tracklib.analysis.bild.neda.</code><code class="sig-name descname">Environment</code><span class="sig-paren">(</span><em class="sig-param">traj</em>, <em class="sig-param">model</em>, <em class="sig-param">MCMCSampler</em>, <em class="sig-param">priorfam</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.neda.Environment" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="tracklib.analysis.bild.neda.Environment.for_numInt_pruning">
<em class="property">classmethod </em><code class="sig-name descname">for_numInt_pruning</code><span class="sig-paren">(</span><em class="sig-param">traj</em>, <em class="sig-param">model</em>, <em class="sig-param">MCMCSampler</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.neda.Environment.for_numInt_pruning" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.neda.Environment.runMCMC">
<code class="sig-name descname">runMCMC</code><span class="sig-paren">(</span><em class="sig-param">*prior_params</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.neda.Environment.runMCMC" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.neda.Environment.posterior_density">
<code class="sig-name descname">posterior_density</code><span class="sig-paren">(</span><em class="sig-param">mcmcrun</em>, <em class="sig-param">trace_eval</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.neda.Environment.posterior_density" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.neda.Environment.evidence">
<code class="sig-name descname">evidence</code><span class="sig-paren">(</span><em class="sig-param">mcmcrun</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.neda.Environment.evidence" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.bild.neda.numInt_pruning">
<code class="sig-prename descclassname">tracklib.analysis.bild.neda.</code><code class="sig-name descname">numInt_pruning</code><span class="sig-paren">(</span><em class="sig-param">env</em>, <em class="sig-param">q=0.3</em>, <em class="sig-param">max_iteration=20</em>, <em class="sig-param">update='K'</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.neda.numInt_pruning" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-tracklib.analysis.bild.plot">
<span id="tracklib-analysis-bild-plot"></span><h2><a class="toc-backref" href="#id6">tracklib.analysis.bild.plot</a><a class="headerlink" href="#module-tracklib.analysis.bild.plot" title="Permalink to this headline">¶</a></h2>
<p>Visualizing inference runs</p>
<dl class="function">
<dt id="tracklib.analysis.bild.plot.butterfly">
<code class="sig-prename descclassname">tracklib.analysis.bild.plot.</code><code class="sig-name descname">butterfly</code><span class="sig-paren">(</span><em class="sig-param">traj, fig=None, title='Example trajectory', ylim=[0, None], ylabel='distance', states_cmap='Greens', ensemble_cmap='viridis'</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.plot.butterfly" title="Permalink to this definition">¶</a></dt>
<dd><p>General overview over an inference run</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>traj</strong> (<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><em>Trajectory</em></a>) – should have <code class="docutils literal notranslate"><span class="pre">traj.meta['neda']</span></code> meta data, i.e. have gone through
<a class="reference internal" href="tracklib.analysis.neda.html#tracklib.analysis.neda.neda.main" title="tracklib.analysis.neda.neda.main"><code class="xref any py py-func docutils literal notranslate"><span class="pre">neda.main</span></code></a></p></li>
<li><p><strong>fig</strong> (<em>figure handle</em><em>, </em><em>optional</em>) – the figure to plot into. Will create a new one by default</p></li>
<li><p><strong>title</strong> (<em>string</em><em>, </em><em>optional</em>) – the title for the plot</p></li>
<li><p><strong>ylim</strong> (<em>[</em><em>lower</em><em>, </em><em>higher</em><em>]</em><em>, </em><em>optional</em>) – the y-limits for the plot of the trajectory (can be used to prevent
outliers from distorting the scale)</p></li>
<li><p><strong>ylabel</strong> (<em>string</em><em>, </em><em>optional</em>) – label to attach to the y-axis of the trajectory plot</p></li>
<li><p><strong>states_cmap</strong> (<em>string</em><em>, </em><em>optional</em>) – an identifier for the colormap to use for the display of marginal
probabilities</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="tracklib-analysis-bild-postproc">
<h2><a class="toc-backref" href="#id7">tracklib.analysis.bild.postproc</a><a class="headerlink" href="#tracklib-analysis-bild-postproc" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-tracklib.analysis.bild.priors">
<span id="tracklib-analysis-bild-priors"></span><h2><a class="toc-backref" href="#id8">tracklib.analysis.bild.priors</a><a class="headerlink" href="#module-tracklib.analysis.bild.priors" title="Permalink to this headline">¶</a></h2>
<p>Everything to do with priors</p>
<dl class="class">
<dt id="tracklib.analysis.bild.priors.Prior">
<em class="property">class </em><code class="sig-prename descclassname">tracklib.analysis.bild.priors.</code><code class="sig-name descname">Prior</code><a class="headerlink" href="#tracklib.analysis.bild.priors.Prior" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Abstract base class for priors</p>
<p>When subclassing, you need to provide the <a class="reference internal" href="#tracklib.analysis.bild.priors.Prior.logpi" title="tracklib.analysis.bild.priors.Prior.logpi"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">logpi</span></code></a> method, which should
return the (log) prior probability for an input <a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loopingprofile</span></code></a>. Specifying
<a class="reference internal" href="#tracklib.analysis.bild.priors.Prior.logpi_vectorized" title="tracklib.analysis.bild.priors.Prior.logpi_vectorized"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">logpi_vectorized</span></code></a> is optional, if you can speed up the prior calculation
over an iterable of loopingprofiles.</p>
<dl class="method">
<dt id="tracklib.analysis.bild.priors.Prior.logpi">
<em class="property">abstract </em><code class="sig-name descname">logpi</code><span class="sig-paren">(</span><em class="sig-param">profile</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.priors.Prior.logpi" title="Permalink to this definition">¶</a></dt>
<dd><p>log of prior probability</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>profile</strong> (<a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><em>Loopingprofile</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float</em></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.bild.priors.Prior.logpi_vectorized" title="tracklib.analysis.bild.priors.Prior.logpi_vectorized"><code class="xref py py-meth docutils literal notranslate"><span class="pre">logpi_vectorized()</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.priors.Prior.logpi_vectorized">
<code class="sig-name descname">logpi_vectorized</code><span class="sig-paren">(</span><em class="sig-param">profiles</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.priors.Prior.logpi_vectorized" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the prior on multiple loopingprofiles</p>
<p>By default just sequentially evaluates <a class="reference internal" href="#tracklib.analysis.bild.priors.Prior.logpi" title="tracklib.analysis.bild.priors.Prior.logpi"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">logpi</span></code></a> on the given
loopingprofiles, which of course does not give a speedup.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>profiles</strong> (<em>Sequence</em><em> (</em><em>e.g. list</em><em>) </em><em>of Loopingprofile</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>np.ndarray, dtype=float</em></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.bild.priors.Prior.logpi" title="tracklib.analysis.bild.priors.Prior.logpi"><code class="xref py py-meth docutils literal notranslate"><span class="pre">logpi()</span></code></a></p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tracklib.analysis.bild.priors.UniformPrior">
<em class="property">class </em><code class="sig-prename descclassname">tracklib.analysis.bild.priors.</code><code class="sig-name descname">UniformPrior</code><span class="sig-paren">(</span><em class="sig-param">nStates=2</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.priors.UniformPrior" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tracklib.analysis.bild.priors.Prior" title="tracklib.analysis.bild.priors.Prior"><code class="xref py py-class docutils literal notranslate"><span class="pre">tracklib.analysis.bild.priors.Prior</span></code></a></p>
<p>A uniform prior over loopingprofiles</p>
<p>This is simply <span class="math notranslate nohighlight">\(-N\log(n)\)</span> for each <a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loopingprofile</span></code></a>, where <span class="math notranslate nohighlight">\(n\)</span>
is the number of states and <span class="math notranslate nohighlight">\(N\)</span> the number of frames.</p>
<dl class="method">
<dt id="tracklib.analysis.bild.priors.UniformPrior.logpi">
<code class="sig-name descname">logpi</code><span class="sig-paren">(</span><em class="sig-param">profile</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.priors.UniformPrior.logpi" title="Permalink to this definition">¶</a></dt>
<dd><p>log of prior probability</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>profile</strong> (<a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><em>Loopingprofile</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float</em></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">logpi_vectorized()</span></code></p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tracklib.analysis.bild.priors.GeometricPrior">
<em class="property">class </em><code class="sig-prename descclassname">tracklib.analysis.bild.priors.</code><code class="sig-name descname">GeometricPrior</code><span class="sig-paren">(</span><em class="sig-param">logq=0</em>, <em class="sig-param">nStates=2</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.priors.GeometricPrior" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tracklib.analysis.bild.priors.Prior" title="tracklib.analysis.bild.priors.Prior"><code class="xref py py-class docutils literal notranslate"><span class="pre">tracklib.analysis.bild.priors.Prior</span></code></a></p>
<p>A geometric prior over #switches in the <a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loopingprofile</span></code></a></p>
<p>Writing <span class="math notranslate nohighlight">\(\theta\)</span> for the <a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loopingprofile</span></code></a> and <span class="math notranslate nohighlight">\(k(\theta)\)</span> for the
number of switches therein, this is given by</p>
<div class="math notranslate nohighlight">
\[\pi(\theta) = \frac{1}{n}(1+(n-1)q)^{N-1} q^{k(\theta)}\,,\]</div>
<p>where <span class="math notranslate nohighlight">\(q\in(0, 1]\)</span> is the one parameter of this prior, <span class="math notranslate nohighlight">\(n\)</span> is
the number of possible states and <span class="math notranslate nohighlight">\(N\)</span> is the number of (valid) frames
in the trajectory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logq</strong> (<em>float &lt; 0</em>) – log of the parameter q</p></li>
<li><p><strong>nStates</strong> (<em>int</em><em>, </em><em>optional</em>) – the number of possible states</p></li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt id="tracklib.analysis.bild.priors.GeometricPrior.logq">
<code class="sig-name descname">logq</code><a class="headerlink" href="#tracklib.analysis.bild.priors.GeometricPrior.logq" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tracklib.analysis.bild.priors.GeometricPrior.n">
<code class="sig-name descname">n</code><a class="headerlink" href="#tracklib.analysis.bild.priors.GeometricPrior.n" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.priors.GeometricPrior.logpi">
<code class="sig-name descname">logpi</code><span class="sig-paren">(</span><em class="sig-param">profile</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.priors.GeometricPrior.logpi" title="Permalink to this definition">¶</a></dt>
<dd><p>log of prior probability</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>profile</strong> (<a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><em>Loopingprofile</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float</em></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.bild.priors.GeometricPrior.logpi_vectorized" title="tracklib.analysis.bild.priors.GeometricPrior.logpi_vectorized"><code class="xref py py-meth docutils literal notranslate"><span class="pre">logpi_vectorized()</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.priors.GeometricPrior.logpi_vectorized">
<code class="sig-name descname">logpi_vectorized</code><span class="sig-paren">(</span><em class="sig-param">profiles</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.priors.GeometricPrior.logpi_vectorized" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the prior on multiple loopingprofiles</p>
<p>By default just sequentially evaluates <a class="reference internal" href="#tracklib.analysis.bild.priors.GeometricPrior.logpi" title="tracklib.analysis.bild.priors.GeometricPrior.logpi"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">logpi</span></code></a> on the given
loopingprofiles, which of course does not give a speedup.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>profiles</strong> (<em>Sequence</em><em> (</em><em>e.g. list</em><em>) </em><em>of Loopingprofile</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>np.ndarray, dtype=float</em></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.bild.priors.GeometricPrior.logpi" title="tracklib.analysis.bild.priors.GeometricPrior.logpi"><code class="xref py py-meth docutils literal notranslate"><span class="pre">logpi()</span></code></a></p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tracklib.analysis.bild.priors.UniformKPrior_NONORM">
<em class="property">class </em><code class="sig-prename descclassname">tracklib.analysis.bild.priors.</code><code class="sig-name descname">UniformKPrior_NONORM</code><span class="sig-paren">(</span><em class="sig-param">nStates=2</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.priors.UniformKPrior_NONORM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tracklib.analysis.bild.priors.Prior" title="tracklib.analysis.bild.priors.Prior"><code class="xref py py-class docutils literal notranslate"><span class="pre">tracklib.analysis.bild.priors.Prior</span></code></a></p>
<p>A prior that has uniform distribution of #switches</p>
<dl class="method">
<dt id="tracklib.analysis.bild.priors.UniformKPrior_NONORM.logpi">
<code class="sig-name descname">logpi</code><span class="sig-paren">(</span><em class="sig-param">profile</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.priors.UniformKPrior_NONORM.logpi" title="Permalink to this definition">¶</a></dt>
<dd><p>log of prior probability</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>profile</strong> (<a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><em>Loopingprofile</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float</em></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">logpi_vectorized()</span></code></p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tracklib.analysis.bild.priors.FixedSwitchPrior">
<em class="property">class </em><code class="sig-prename descclassname">tracklib.analysis.bild.priors.</code><code class="sig-name descname">FixedSwitchPrior</code><span class="sig-paren">(</span><em class="sig-param">K</em>, <em class="sig-param">nStates=2</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.priors.FixedSwitchPrior" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tracklib.analysis.bild.priors.Prior" title="tracklib.analysis.bild.priors.Prior"><code class="xref py py-class docutils literal notranslate"><span class="pre">tracklib.analysis.bild.priors.Prior</span></code></a></p>
<p>Prior for a fixed number of switches</p>
<dl class="method">
<dt id="tracklib.analysis.bild.priors.FixedSwitchPrior.logpi">
<code class="sig-name descname">logpi</code><span class="sig-paren">(</span><em class="sig-param">profile</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.priors.FixedSwitchPrior.logpi" title="Permalink to this definition">¶</a></dt>
<dd><p>log of prior probability</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>profile</strong> (<a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><em>Loopingprofile</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float</em></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">logpi_vectorized()</span></code></p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tracklib.analysis.bild.priors.MaxSwitchPrior">
<em class="property">class </em><code class="sig-prename descclassname">tracklib.analysis.bild.priors.</code><code class="sig-name descname">MaxSwitchPrior</code><span class="sig-paren">(</span><em class="sig-param">K</em>, <em class="sig-param">logq=0</em>, <em class="sig-param">nStates=2</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.priors.MaxSwitchPrior" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tracklib.analysis.bild.priors.Prior" title="tracklib.analysis.bild.priors.Prior"><code class="xref py py-class docutils literal notranslate"><span class="pre">tracklib.analysis.bild.priors.Prior</span></code></a></p>
<p>Prior for limiting number of switches</p>
<dl class="method">
<dt id="tracklib.analysis.bild.priors.MaxSwitchPrior.logpi">
<code class="sig-name descname">logpi</code><span class="sig-paren">(</span><em class="sig-param">profile</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.priors.MaxSwitchPrior.logpi" title="Permalink to this definition">¶</a></dt>
<dd><p>log of prior probability</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>profile</strong> (<a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><em>Loopingprofile</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float</em></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">logpi_vectorized()</span></code></p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tracklib.analysis.bild.priors.NumIntPrior">
<em class="property">class </em><code class="sig-prename descclassname">tracklib.analysis.bild.priors.</code><code class="sig-name descname">NumIntPrior</code><span class="sig-paren">(</span><em class="sig-param">numInt</em>, <em class="sig-param">logq=0</em>, <em class="sig-param">nStates=2</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.priors.NumIntPrior" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tracklib.analysis.bild.priors.Prior" title="tracklib.analysis.bild.priors.Prior"><code class="xref py py-class docutils literal notranslate"><span class="pre">tracklib.analysis.bild.priors.Prior</span></code></a></p>
<p>Prior designed to reproduce the effects of Chris’ numInt scheme</p>
<dl class="method">
<dt id="tracklib.analysis.bild.priors.NumIntPrior.logpi">
<code class="sig-name descname">logpi</code><span class="sig-paren">(</span><em class="sig-param">profile</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.priors.NumIntPrior.logpi" title="Permalink to this definition">¶</a></dt>
<dd><p>log of prior probability</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>profile</strong> (<a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><em>Loopingprofile</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float</em></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">logpi_vectorized()</span></code></p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-tracklib.analysis.bild.util">
<span id="tracklib-analysis-bild-util"></span><h2><a class="toc-backref" href="#id9">tracklib.analysis.bild.util</a><a class="headerlink" href="#module-tracklib.analysis.bild.util" title="Permalink to this headline">¶</a></h2>
<p>Useful constructs used throughout the <a class="reference internal" href="#module-tracklib.analysis.bild.neda" title="tracklib.analysis.bild.neda"><code class="xref any py py-mod docutils literal notranslate"><span class="pre">neda</span></code></a> module</p>
<dl class="class">
<dt id="tracklib.analysis.bild.util.Loopingprofile">
<em class="property">class </em><code class="sig-prename descclassname">tracklib.analysis.bild.util.</code><code class="sig-name descname">Loopingprofile</code><span class="sig-paren">(</span><em class="sig-param">states=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.util.Loopingprofile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Use plt.stairs(profile, edges=np.arange(-1, len(profile))) for plotting.</p>
<dl class="method">
<dt id="tracklib.analysis.bild.util.Loopingprofile.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.util.Loopingprofile.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.util.Loopingprofile.count_switches">
<code class="sig-name descname">count_switches</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.util.Loopingprofile.count_switches" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.util.Loopingprofile.intervals">
<code class="sig-name descname">intervals</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.util.Loopingprofile.intervals" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.util.Loopingprofile.plottable">
<code class="sig-name descname">plottable</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.util.Loopingprofile.plottable" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="tracklib.analysis.bild.util.ParametricFamily">
<em class="property">class </em><code class="sig-prename descclassname">tracklib.analysis.bild.util.</code><code class="sig-name descname">ParametricFamily</code><span class="sig-paren">(</span><em class="sig-param">start_params</em>, <em class="sig-param">bounds</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.util.ParametricFamily" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A base class for parametric families</p>
<p>This class is a template for parametric families of any type, i.e. its main
capability (<a class="reference internal" href="#tracklib.analysis.bild.util.ParametricFamily.get" title="tracklib.analysis.bild.util.ParametricFamily.get"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">get</span></code></a>) converts a set of parameters into an object, e.g. a
<a class="reference internal" href="#tracklib.analysis.bild.priors.Prior" title="tracklib.analysis.bild.priors.Prior"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Prior</span></code></a> or <a class="reference internal" href="tracklib.analysis.neda.html#tracklib.analysis.neda.models.Model" title="tracklib.analysis.neda.models.Model"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>. On top of that, meta information like
bounds for parameters is stored here. In summary, this class provides the
interface we need generically for fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_params</strong> (<em>tuple of float</em>) – the initial parameters</p></li>
<li><p><strong>bounds</strong> (<em>list of</em><em> (</em><em>lower</em><em>, </em><em>higher</em><em>) </em><em>tuples</em>) – domain for each parameter</p></li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt id="tracklib.analysis.bild.util.ParametricFamily.start_params">
<code class="sig-name descname">start_params</code><a class="headerlink" href="#tracklib.analysis.bild.util.ParametricFamily.start_params" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple of float</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tracklib.analysis.bild.util.ParametricFamily.nParams">
<code class="sig-name descname">nParams</code><a class="headerlink" href="#tracklib.analysis.bild.util.ParametricFamily.nParams" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tracklib.analysis.bild.util.ParametricFamily.bounds">
<code class="sig-name descname">bounds</code><a class="headerlink" href="#tracklib.analysis.bild.util.ParametricFamily.bounds" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of (lower, higher) tuples</p>
</dd>
</dl>
</dd></dl>

<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">fit_model</span></code></p>
</div>
<p class="rubric">Notes</p>
<p>This class uses the call syntax as an alias for <a class="reference internal" href="#tracklib.analysis.bild.util.ParametricFamily.get" title="tracklib.analysis.bild.util.ParametricFamily.get"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">get</span></code></a>, i.e. in the examples
below <code class="docutils literal notranslate"><span class="pre">fam(...)</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">fam.get(...)</span></code>.</p>
<p class="rubric">Example</p>
<p>A family of <a class="reference internal" href="#tracklib.analysis.bild.priors.GeometricPrior" title="tracklib.analysis.bild.priors.GeometricPrior"><code class="xref any py py-class docutils literal notranslate"><span class="pre">priors.GeometricPrior</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fam</span> <span class="o">=</span> <span class="n">ParametricFamily</span><span class="p">((</span><span class="mi">0</span><span class="p">,),</span> <span class="p">[(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
<span class="gp">... </span><span class="n">fam</span><span class="o">.</span><span class="n">get</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">logq</span> <span class="p">:</span> <span class="n">priors</span><span class="o">.</span><span class="n">GeometricPrior</span><span class="p">(</span><span class="n">logq</span><span class="p">,</span> <span class="n">nStates</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that <a class="reference internal" href="#tracklib.analysis.bild.priors.GeometricPrior" title="tracklib.analysis.bild.priors.GeometricPrior"><code class="xref any py py-class docutils literal notranslate"><span class="pre">GeometricPrior</span></code></a> also has a <a class="reference internal" href="tracklib.analysis.neda.html#tracklib.analysis.neda.priors.GeometricPrior.family" title="tracklib.analysis.neda.priors.GeometricPrior.family"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">family</span></code></a> method providing essentially
this construction.</p>
<p>A family of three state <a class="reference internal" href="tracklib.analysis.neda.html#tracklib.analysis.neda.models.RouseModel" title="tracklib.analysis.neda.models.RouseModel"><code class="xref any py py-class docutils literal notranslate"><span class="pre">RouseModels</span></code></a>, which is then
fitted to a calibration dataset <code class="xref any docutils literal notranslate"><span class="pre">data</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fam</span> <span class="o">=</span> <span class="n">ParametricFamily</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">[(</span><span class="mf">1e-10</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mf">1e-10</span><span class="p">,</span> <span class="kc">None</span><span class="p">)])</span>
<span class="gp">... </span><span class="n">fam</span><span class="o">.</span><span class="n">get</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">D</span><span class="p">,</span> <span class="n">k</span> <span class="p">:</span> <span class="n">models</span><span class="o">.</span><span class="n">RouseModel</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">looppositions</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">... </span><span class="n">fitresult</span> <span class="o">=</span> <span class="n">fit_model</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">fam</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that you cannot use the framework provided here to optimize e.g. the
number of monomers <code class="xref any docutils literal notranslate"><span class="pre">N</span></code>, since that is an integer programming problem. One
could imagine comparing runs with different (fixed) <code class="xref any docutils literal notranslate"><span class="pre">N</span></code> though.</p>
<dl class="method">
<dt id="tracklib.analysis.bild.util.ParametricFamily.get">
<code class="sig-name descname">get</code><span class="sig-paren">(</span><em class="sig-param">*params</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.util.ParametricFamily.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate an object from the given parameters</p>
<p>This function should be overwritten upon instantiation</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.bild.util.stateProbabilities">
<code class="sig-prename descclassname">tracklib.analysis.bild.util.</code><code class="sig-name descname">stateProbabilities</code><span class="sig-paren">(</span><em class="sig-param">profiles</em>, <em class="sig-param">nStates=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.util.stateProbabilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate marginal probabilities for an ensemble of profiles</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>profiles</strong> (<em>iterable of Loopingprofile</em>) – the profiles to use</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>(n, T) np.ndarray</em> – the marginal probabilities for each state at each time point</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">tracklib.analysis.bild</a><ul>
<li><a class="reference internal" href="#module-tracklib.analysis.bild.bild">tracklib.analysis.bild.bild</a></li>
<li><a class="reference internal" href="#module-tracklib.analysis.bild.kebys">tracklib.analysis.bild.kebys</a></li>
<li><a class="reference internal" href="#module-tracklib.analysis.bild.mcmc">tracklib.analysis.bild.mcmc</a></li>
<li><a class="reference internal" href="#module-tracklib.analysis.bild.models">tracklib.analysis.bild.models</a></li>
<li><a class="reference internal" href="#module-tracklib.analysis.bild.neda">tracklib.analysis.bild.neda</a></li>
<li><a class="reference internal" href="#module-tracklib.analysis.bild.plot">tracklib.analysis.bild.plot</a></li>
<li><a class="reference internal" href="#tracklib-analysis-bild-postproc">tracklib.analysis.bild.postproc</a></li>
<li><a class="reference internal" href="#module-tracklib.analysis.bild.priors">tracklib.analysis.bild.priors</a></li>
<li><a class="reference internal" href="#module-tracklib.analysis.bild.util">tracklib.analysis.bild.util</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="tracklib.analysis.html"
                        title="previous chapter">tracklib.analysis</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tracklib.analysis.msdfit.html"
                        title="next chapter">tracklib.analysis.msdfit</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tracklib.analysis.bild.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tracklib.analysis.msdfit.html" title="tracklib.analysis.msdfit"
             >next</a> |</li>
        <li class="right" >
          <a href="tracklib.analysis.html" title="tracklib.analysis"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">tracklib 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="tracklib.html" >tracklib</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="tracklib.analysis.html" >tracklib.analysis</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Simon Grosse-Holz.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.1.2.
    </div>
  </body>
</html>