
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>tracklib.analysis.bild &#8212; tracklib 0.1 documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="tracklib.analysis.msdfit" href="tracklib.analysis.msdfit.html" />
    <link rel="prev" title="tracklib.analysis" href="tracklib.analysis.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tracklib.analysis.msdfit.html" title="tracklib.analysis.msdfit"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tracklib.analysis.html" title="tracklib.analysis"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">tracklib 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="tracklib.html" >tracklib</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="tracklib.analysis.html" accesskey="U">tracklib.analysis</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tracklib-analysis-bild">
<h1>tracklib.analysis.bild<a class="headerlink" href="#tracklib-analysis-bild" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#module-tracklib.analysis.bild.amis" id="id1">tracklib.analysis.bild.amis</a></p></li>
<li><p><a class="reference internal" href="#module-tracklib.analysis.bild.core" id="id2">tracklib.analysis.bild.core</a></p></li>
<li><p><a class="reference internal" href="#module-tracklib.analysis.bild.models" id="id3">tracklib.analysis.bild.models</a></p></li>
<li><p><a class="reference internal" href="#module-tracklib.analysis.bild.postproc" id="id4">tracklib.analysis.bild.postproc</a></p></li>
<li><p><a class="reference internal" href="#module-tracklib.analysis.bild.util" id="id5">tracklib.analysis.bild.util</a></p></li>
</ul>
</div>
<div class="section" id="module-tracklib.analysis.bild.amis">
<span id="tracklib-analysis-bild-amis"></span><h2><a class="toc-backref" href="#id1">tracklib.analysis.bild.amis</a><a class="headerlink" href="#module-tracklib.analysis.bild.amis" title="Permalink to this headline">¶</a></h2>
<p>Implementation of AMIS for posterior sampling at fixed k</p>
<p>This module provides the implementation of the AMIS (<a class="reference external" href="https://doi.org/10.1111/j.1467-9469.2011.00756.x">Cornuet et al. 2012</a>) sampling scheme for BILD,
at a fixed number of switches <code class="docutils literal notranslate"><span class="pre">k</span></code> in the profile. The <a class="reference internal" href="#tracklib.analysis.bild.amis.FixedkSampler" title="tracklib.analysis.bild.amis.FixedkSampler"><code class="xref any py py-class docutils literal notranslate"><span class="pre">FixedkSampler</span></code></a> class
provides the full interface, while the other functions in the module define the
sampling scheme.</p>
<dl class="simple">
<dt>We parametrize the binary profiles as <code class="docutils literal notranslate"><span class="pre">(s,</span> <span class="pre">theta)</span></code> where</dt><dd><ul class="simple">
<li><p>s is a vector of interval lengths, as fraction of the whole trajectory. It
thus has dimension <code class="docutils literal notranslate"><span class="pre">k+1</span></code> and satisfies <code class="docutils literal notranslate"><span class="pre">sum(s)</span> <span class="pre">=</span> <span class="pre">1</span></code>, as well as <code class="docutils literal notranslate"><span class="pre">s_i</span> <span class="pre">&gt;</span>
<span class="pre">0</span> <span class="pre">forall</span> <span class="pre">i</span></code>.</p></li>
<li><p>theta is the looping state of the first interval. Since the profiles are
binary, this determines the state of all subsequent intervals. Clearly <code class="docutils literal notranslate"><span class="pre">θ</span>
<span class="pre">in</span> <span class="pre">{0,</span> <span class="pre">1}</span></code>.</p></li>
</ul>
</dd>
</dl>
<p>The conversion from the parametrization <code class="docutils literal notranslate"><span class="pre">(s,</span> <span class="pre">θ)</span></code> to discretely sampled
profiles is according to the following scheme:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>profile:            θ     p     p     p     p     p
trajectory:       -----x-----x-----x-----x-----x-----x
position:             0.0   0.2   0.4   0.6   0.8   1.0

example (s):           ==0.25==|=====0.5=====|==0.25==
switch positions:              |(0.25)       |(0.75)
conversion:            |&lt;&lt;&lt;&lt;&lt;|&lt;&lt;&lt;&lt;&lt;|&lt;&lt;&lt;&lt;&lt;|&lt;&lt;&lt;&lt;&lt;|&lt;&lt;&lt;&lt;&lt;
result (θ=0):       0     0  &#39;  1     1  &#39;  0     0
</pre></div>
</div>
<p>Note that the conversion step amounts to a simple <code class="docutils literal notranslate"><span class="pre">floor()</span></code> operation on the
switch positions. We chose this conversion over the maybe more “natural” one of
rounding to the nearest integer because it guarantees</p>
<blockquote>
<div><ul class="simple">
<li><p>that a uniformly distributed continuous switch position will still be
uniformly distributed over its possible discrete positions.</p></li>
<li><p>conservation of switches: a switch at .99 would disappear from the profile
with the rounding scheme. Importantly, note that in either case an interval
shorter than the framerate will likely not be represented in the profile,
and thus switches are not always conserved. However, if such profiles are
the main contribution to the evidence for this number of switches, we should
(and do!) just choose the appropriate lower number of switches instead.</p></li>
</ul>
</div></blockquote>
<dl class="function">
<dt id="tracklib.analysis.bild.amis.st2profile">
<code class="sig-prename descclassname">tracklib.analysis.bild.amis.</code><code class="sig-name descname">st2profile</code><span class="sig-paren">(</span><em class="sig-param">s</em>, <em class="sig-param">theta</em>, <em class="sig-param">traj</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.amis.st2profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert AMIS parameters (s, θ) to Loopingprofile for given trajectory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>s</em><em>,</em>) – </p></li>
<li><p><strong>traj</strong> (<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><em>Trajectory</em></a>) – needed to determine discretization. In fact, only <code class="docutils literal notranslate"><span class="pre">len(traj)</span></code> is
evaluated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Loopingprofile</em></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.bild.amis.dirichlet_methodofmoments">
<code class="sig-prename descclassname">tracklib.analysis.bild.amis.</code><code class="sig-name descname">dirichlet_methodofmoments</code><span class="sig-paren">(</span><em class="sig-param">ss</em>, <em class="sig-param">normalized_weights</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.amis.dirichlet_methodofmoments" title="Permalink to this definition">¶</a></dt>
<dd><p>Method of moments estimator for the Dirichlet distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ss</strong> (<em>(</em><em>n</em><em>, </em><em>k+1</em><em>) </em><em>np.ndarray</em><em>, </em><em>dtype=float</em>) – the switch positions <code class="docutils literal notranslate"><span class="pre">s</span></code> for a sample of size <code class="docutils literal notranslate"><span class="pre">n</span></code></p></li>
<li><p><strong>normalized_weights</strong> (<em>(</em><em>n</em><em>,</em><em>) </em><em>np.ndarray</em><em>, </em><em>dtype=float</em>) – the associated weights for all samples. Should satisfy
<code class="docutils literal notranslate"><span class="pre">np.sum(normalized_weights)</span> <span class="pre">=</span> <span class="pre">1</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>(k+1,) np.ndarray</em> – the concentration parameters for the fitted Dirichlet distribution</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>We use the method of moments, because it is straight-forward to apply to a
weighted sample. Given an ensemble of switch positions <code class="docutils literal notranslate"><span class="pre">s</span></code>, we have</p>
<blockquote>
<div><ul class="simple">
<li><p>the mean positions <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">=</span> <span class="pre">&lt;s&gt;</span></code></p></li>
<li><p>the variances <code class="docutils literal notranslate"><span class="pre">v</span> <span class="pre">=</span> <span class="pre">&lt;(s-m)²&gt;</span></code></p></li>
<li><p>from this we can find the total concentration as <code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">=</span> <span class="pre">mean(m*(1-m)/v)</span> <span class="pre">-</span>
<span class="pre">1</span></code></p></li>
<li><p>thus yielding the final estimate of <code class="docutils literal notranslate"><span class="pre">α</span> <span class="pre">=</span> <span class="pre">A*m</span></code>.</p></li>
</ul>
</div></blockquote>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.bild.amis.sample_proposal" title="tracklib.analysis.bild.amis.sample_proposal"><code class="xref py py-func docutils literal notranslate"><span class="pre">sample_proposal()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.bild.amis.logL">
<code class="sig-prename descclassname">tracklib.analysis.bild.amis.</code><code class="sig-name descname">logL</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.amis.logL" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the model likelihood for a given profile</p>
<p>The argument to this function is an aggregate of all the necessary
information, such that we can evaluate it in parallel (see
<a class="reference internal" href="#tracklib.analysis.bild.amis.calculate_logLs" title="tracklib.analysis.bild.amis.calculate_logLs"><code class="xref any py py-func docutils literal notranslate"><span class="pre">calculate_logLs</span></code></a>). Its structure is <code class="docutils literal notranslate"><span class="pre">params</span> <span class="pre">=</span> <span class="pre">((s,</span> <span class="pre">theta),</span> <span class="pre">(traj,</span>
<span class="pre">model))</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>s</em><em>,</em>) – </p></li>
<li><p><strong>traj</strong> (<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><em>Trajectory</em></a>) – </p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel" title="tracklib.analysis.bild.models.MultiStateModel"><em>MultiStateModel</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float</em></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.bild.amis.calculate_logLs" title="tracklib.analysis.bild.amis.calculate_logLs"><code class="xref py py-func docutils literal notranslate"><span class="pre">calculate_logLs()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.bild.amis.calculate_logLs">
<code class="sig-prename descclassname">tracklib.analysis.bild.amis.</code><code class="sig-name descname">calculate_logLs</code><span class="sig-paren">(</span><em class="sig-param">ss</em>, <em class="sig-param">thetas</em>, <em class="sig-param">traj</em>, <em class="sig-param">model</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.amis.calculate_logLs" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the likelihood on an ensemple of profiles</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ss</strong> (<em>(</em><em>n</em><em>, </em><em>k+1</em><em>) </em><em>np.ndarray</em><em>, </em><em>dtype=float</em>) – </p></li>
<li><p><strong>thetas</strong> (<em>(</em><em>n</em><em>,</em><em>) </em><em>np.ndarray</em><em>, </em><em>dtype=int</em>) – </p></li>
<li><p><strong>traj</strong> (<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><em>Trajectory</em></a>) – </p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel" title="tracklib.analysis.bild.models.MultiStateModel"><em>MultiStateModel</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>(n,) np.ndarray, dtype=float</em> – the likelihoods associated with each profile</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function is parallel-aware (ordered). See <a class="reference internal" href="tracklib.util.html#module-tracklib.util.parallel" title="tracklib.util.parallel"><code class="xref any py py-mod docutils literal notranslate"><span class="pre">tracklib.util.parallel</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.bild.amis.proposal">
<code class="sig-prename descclassname">tracklib.analysis.bild.amis.</code><code class="sig-name descname">proposal</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">m</em>, <em class="sig-param">ss</em>, <em class="sig-param">thetas</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.amis.proposal" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the proposal distribution at a given point</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>a</em><em>,</em>) – the parameters for the proposal distribution (Dirichlet(α) x
Bernoulli(m))</p></li>
<li><p><strong>ss</strong> (<em>(</em><em>n</em><em>, </em><em>k+1</em><em>) </em><em>np.ndarray</em><em>, </em><em>dtype=float</em>) – </p></li>
<li><p><strong>thetas</strong> (<em>(</em><em>n</em><em>,</em><em>) </em><em>np.ndarray</em><em>, </em><em>dtype=int</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float</em></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.bild.amis.sample_proposal" title="tracklib.analysis.bild.amis.sample_proposal"><code class="xref py py-func docutils literal notranslate"><span class="pre">sample_proposal()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.bild.amis.sample_proposal">
<code class="sig-prename descclassname">tracklib.analysis.bild.amis.</code><code class="sig-name descname">sample_proposal</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">m</em>, <em class="sig-param">N</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.amis.sample_proposal" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample from the proposal distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>a</em><em>,</em>) – the parameters for the proposal distribution (Dirichlet(α) x
Bernoulli(m))</p></li>
<li><p><strong>N</strong> (<em>int</em>) – size of the sample</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>ss</strong> (<em>(N, k+1) np.ndarray, dtype=float</em>) – the switch positions for each sample</p></li>
<li><p><strong>thetas</strong> (<em>(N,) np.ndarray, dtype=int</em>) – the initial state for each sample</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.bild.amis.fit_proposal" title="tracklib.analysis.bild.amis.fit_proposal"><code class="xref py py-func docutils literal notranslate"><span class="pre">fit_proposal()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.bild.amis.fit_proposal">
<code class="sig-prename descclassname">tracklib.analysis.bild.amis.</code><code class="sig-name descname">fit_proposal</code><span class="sig-paren">(</span><em class="sig-param">ss</em>, <em class="sig-param">thetas</em>, <em class="sig-param">weights</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.amis.fit_proposal" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the proposal distribution to a weighted sample</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ss</strong> (<em>(</em><em>n</em><em>, </em><em>k+1</em><em>) </em><em>np.ndarray</em><em>, </em><em>dtype=float</em>) – </p></li>
<li><p><strong>thetas</strong> (<em>(</em><em>n</em><em>,</em><em>) </em><em>np.ndarray</em><em>, </em><em>dtype=int</em>) – </p></li>
<li><p><strong>weights</strong> (<em>(</em><em>n</em><em>,</em><em>) </em><em>np.ndarray</em><em>, </em><em>dtype=float</em>) – the weights associated with the sample <code class="docutils literal notranslate"><span class="pre">(ss,</span> <span class="pre">thetas)</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>a, m</strong> (<em>(k+1,) np.ndarray, dtype=float; float in [0, 1]</em>) – the parameters for the proposal distribution (Dirichlet(α) x
Bernoulli(m))</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.bild.amis.sample_proposal" title="tracklib.analysis.bild.amis.sample_proposal"><code class="xref py py-func docutils literal notranslate"><span class="pre">sample_proposal()</span></code></a>, <a class="reference internal" href="#tracklib.analysis.bild.amis.dirichlet_methodofmoments" title="tracklib.analysis.bild.amis.dirichlet_methodofmoments"><code class="xref py py-func docutils literal notranslate"><span class="pre">dirichlet_methodofmoments()</span></code></a></p>
</div>
</dd></dl>

<dl class="exception">
<dt id="tracklib.analysis.bild.amis.ExhaustionImpractical">
<em class="property">exception </em><code class="sig-prename descclassname">tracklib.analysis.bild.amis.</code><code class="sig-name descname">ExhaustionImpractical</code><a class="headerlink" href="#tracklib.analysis.bild.amis.ExhaustionImpractical" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ValueError</span></code></p>
</dd></dl>

<dl class="class">
<dt id="tracklib.analysis.bild.amis.FixedkSampler">
<em class="property">class </em><code class="sig-prename descclassname">tracklib.analysis.bild.amis.</code><code class="sig-name descname">FixedkSampler</code><span class="sig-paren">(</span><em class="sig-param">traj</em>, <em class="sig-param">model</em>, <em class="sig-param">k</em>, <em class="sig-param">N=100</em>, <em class="sig-param">concentration_brake=0.01</em>, <em class="sig-param">polarization_brake=0.001</em>, <em class="sig-param">max_fev=20000</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.amis.FixedkSampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Running the AMIS scheme for a fixed number of switches k</p>
<p>The most important method is <a class="reference internal" href="#tracklib.analysis.bild.amis.FixedkSampler.step" title="tracklib.analysis.bild.amis.FixedkSampler.step"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">step</span></code></a>, which performs one AMIS iteration,
i.e. it samples <code class="xref any docutils literal notranslate"><span class="pre">N</span></code> profiles from the current proposal and updates the
weights and proposal parameters accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>traj</strong> (<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><em>Trajectory</em></a>) – the trajectory we are sampling for</p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel" title="tracklib.analysis.bild.models.MultiStateModel"><em>MultiStateModel</em></a>) – the model to use (defines the likelihood)</p></li>
<li><p><strong>k</strong> (<em>int</em>) – the number of switches for this run</p></li>
<li><p><strong>N</strong> (<em>int</em><em>, </em><em>optional</em>) – the sample size for each AMIS step</p></li>
<li><p><strong>concentration_brake</strong> (<em>float</em><em>, </em><em>optional</em>) – limits changes in the total concentration of the Dirichlet proposal by
constraining <code class="docutils literal notranslate"><span class="pre">|log(new_concentration/old_concentration)|</span> <span class="pre">&lt;=</span>
<span class="pre">N*concentration_brake</span></code>, where <code class="docutils literal notranslate"><span class="pre">concentration</span> <span class="pre">=</span> <span class="pre">sum(α)</span></code>.</p></li>
<li><p><strong>polarization_brake</strong> (<em>float</em><em>, </em><em>optional</em>) – limits changes in the polarization (Bernoulli part of the proposal) by
constraining <code class="docutils literal notranslate"><span class="pre">|m_new</span> <span class="pre">-</span> <span class="pre">m_old|</span> <span class="pre">&lt;=</span> <span class="pre">N*polarization_brake</span></code>.</p></li>
<li><p><strong>max_fev</strong> (<em>int</em><em>, </em><em>optional</em>) – limit on likelihood evaluations. If this limit is reached, the sampler
will go to an “exhausted” state, where it does not allow further
evaluations. Will be rounded down to integer multiple of <code class="xref any docutils literal notranslate"><span class="pre">N</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt>
<code class="sig-name descname">traj, model</code></dt>
<dd><p>setup for the sampling. See Parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory">Trajectory</a>, <a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel" title="tracklib.analysis.bild.models.MultiStateModel">MultiStateModel</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">k, N</code></dt>
<dd><p>see Parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tracklib.analysis.bild.amis.FixedkSampler.brakes">
<code class="sig-name descname">brakes</code><a class="headerlink" href="#tracklib.analysis.bild.amis.FixedkSampler.brakes" title="Permalink to this definition">¶</a></dt>
<dd><p>see Parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>(concentration, polarization)</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tracklib.analysis.bild.amis.FixedkSampler.max_fev">
<code class="sig-name descname">max_fev</code><a class="headerlink" href="#tracklib.analysis.bild.amis.FixedkSampler.max_fev" title="Permalink to this definition">¶</a></dt>
<dd><p>see Parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tracklib.analysis.bild.amis.FixedkSampler.exhausted">
<code class="sig-name descname">exhausted</code><a class="headerlink" href="#tracklib.analysis.bild.amis.FixedkSampler.exhausted" title="Permalink to this definition">¶</a></dt>
<dd><p>the state of the sampler. See <a class="reference internal" href="#tracklib.analysis.bild.amis.FixedkSampler.step" title="tracklib.analysis.bild.amis.FixedkSampler.step"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">step</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tracklib.analysis.bild.amis.FixedkSampler.samples">
<code class="sig-name descname">samples</code><a class="headerlink" href="#tracklib.analysis.bild.amis.FixedkSampler.samples" title="Permalink to this definition">¶</a></dt>
<dd><p>list of samples. Each samples is a list <code class="docutils literal notranslate"><span class="pre">[ss,</span> <span class="pre">thetas,</span> <span class="pre">logLs,</span> <span class="pre">deltas,</span>
<span class="pre">weights]</span></code> where each entry is an <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">...)</span> <span class="pre">np.ndarray</span></code>. <code class="docutils literal notranslate"><span class="pre">ss</span></code> and
<code class="docutils literal notranslate"><span class="pre">thetas</span></code> define the <code class="xref any docutils literal notranslate"><span class="pre">N</span></code> sample points, <code class="docutils literal notranslate"><span class="pre">logLs</span></code> are the associated
likelihoods, <code class="docutils literal notranslate"><span class="pre">deltas</span></code> are auxiliary variables for AMIS, and
<code class="docutils literal notranslate"><span class="pre">weights</span></code> are the associated weights for each point (updated at each
<a class="reference internal" href="#tracklib.analysis.bild.amis.FixedkSampler.step" title="tracklib.analysis.bild.amis.FixedkSampler.step"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">step</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tracklib.analysis.bild.amis.FixedkSampler.parameters">
<code class="sig-name descname">parameters</code><a class="headerlink" href="#tracklib.analysis.bild.amis.FixedkSampler.parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>proposal parameters for the samples in <code class="xref any docutils literal notranslate"><span class="pre">samples</span></code>, as tuple <code class="docutils literal notranslate"><span class="pre">(a,</span> <span class="pre">m)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>[((k+1,) np.ndarray, float)]</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tracklib.analysis.bild.amis.FixedkSampler.evidences">
<code class="sig-name descname">evidences</code><a class="headerlink" href="#tracklib.analysis.bild.amis.FixedkSampler.evidences" title="Permalink to this definition">¶</a></dt>
<dd><p>estimated evidence at each step. Similar to <code class="xref any docutils literal notranslate"><span class="pre">samples</span></code> and
<code class="xref any docutils literal notranslate"><span class="pre">parameters</span></code>, this is a list with an entry for each <a class="reference internal" href="#tracklib.analysis.bild.amis.FixedkSampler.step" title="tracklib.analysis.bild.amis.FixedkSampler.step"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">step</span></code></a>. The
entries are tuples of log-evidence, standard error on the log-evidence,
and Kullback-Leibler divergence <code class="docutils literal notranslate"><span class="pre">D_KL(</span> <span class="pre">proposal</span> <span class="pre">||</span> <span class="pre">posterior</span> <span class="pre">)</span></code> of
proposal on posterior. The latter can come in handy in interpreting
convergence.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>[(logE, dlogE, KL)]</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tracklib.analysis.bild.amis.FixedkSampler.max_logL">
<code class="sig-name descname">max_logL</code><a class="headerlink" href="#tracklib.analysis.bild.amis.FixedkSampler.max_logL" title="Permalink to this definition">¶</a></dt>
<dd><p>maximum value of the likelihood. Used internally to prevent overflows.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tracklib.analysis.bild.amis.FixedkSampler.logprior">
<code class="sig-name descname">logprior</code><a class="headerlink" href="#tracklib.analysis.bild.amis.FixedkSampler.logprior" title="Permalink to this definition">¶</a></dt>
<dd><p>value of the uniform prior over profiles. Used internally.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.amis.FixedkSampler.fix_exhaustive">
<code class="sig-name descname">fix_exhaustive</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.amis.FixedkSampler.fix_exhaustive" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate by exhaustive sampling of the parameter space</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – if parameter space is too big to warrant exhaustive sampling.
    Currently this means <code class="docutils literal notranslate"><span class="pre">self.k</span> <span class="pre">&gt;=</span> <span class="pre">2</span></code>.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Since in this case the evidence is exact, its standard error should be
zero. To avoid numerical issues, we set <code class="docutils literal notranslate"><span class="pre">dlogev</span> <span class="pre">=</span> <span class="pre">1e-10</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.amis.FixedkSampler.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.amis.FixedkSampler.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a single step of the AMIS sampling scheme</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>bool</em> – whether the sample was performed. <code class="docutils literal notranslate"><span class="pre">False</span></code> if sampler is
exhausted, <code class="docutils literal notranslate"><span class="pre">True</span></code> otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.amis.FixedkSampler.t_stat">
<code class="sig-name descname">t_stat</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.amis.FixedkSampler.t_stat" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate separation (by evidence) from another sampler</p>
<p>Inspired by the t-statistic from frequentist inference, we use the
separation score <code class="docutils literal notranslate"><span class="pre">(logev</span> <span class="pre">-</span> <span class="pre">other_logev)</span> <span class="pre">/</span> <span class="pre">sqrt(</span> <span class="pre">dlogev²</span> <span class="pre">+</span>
<span class="pre">other_dlogev²</span> <span class="pre">)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>float</em></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.amis.FixedkSampler.MAP_profile">
<code class="sig-name descname">MAP_profile</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.amis.FixedkSampler.MAP_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Give the current MAP estimate</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>Loopingprofile</em></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-tracklib.analysis.bild.core">
<span id="tracklib-analysis-bild-core"></span><h2><a class="toc-backref" href="#id2">tracklib.analysis.bild.core</a><a class="headerlink" href="#module-tracklib.analysis.bild.core" title="Permalink to this headline">¶</a></h2>
<p>Core implementation of the <a class="reference internal" href="#"><span class="doc">bild</span></a> module</p>
<dl class="function">
<dt id="tracklib.analysis.bild.core.sample">
<code class="sig-prename descclassname">tracklib.analysis.bild.core.</code><code class="sig-name descname">sample</code><span class="sig-paren">(</span><em class="sig-param">traj</em>, <em class="sig-param">model</em>, <em class="sig-param">dE=0</em>, <em class="sig-param">samples_per_step=100</em>, <em class="sig-param">init_runs=20</em>, <em class="sig-param">significant_separation_sem_fold=5</em>, <em class="sig-param">k_lookahead=2</em>, <em class="sig-param">k_max=20</em>, <em class="sig-param">sampler_kw={}</em>, <em class="sig-param">show_progress=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.core.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Entry point for BILD</p>
<p>This function executes the whole BILD scheme, i.e. it takes a trajectory
and returns a best-fit looping profile (plus some of the internally stored
variables that might be of interest for downstream analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajectory</strong> (<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><em>Trajectory</em></a>) – the trajectory to sample for</p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel" title="tracklib.analysis.bild.models.MultiStateModel"><em>MultiStateModel</em></a>) – the model defining the likelihood function</p></li>
<li><p><strong>dE</strong> (<em>float</em><em>, </em><em>optional</em>) – the evidence margin ΔE to apply in finding the actual point estimate</p></li>
</ul>
</dd>
<dt class="field-even">Other Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>samples_per_step</strong> (<em>int</em>) – how many profiles are contained in each AMIS step. See
‘FixedkSampler.step`</p></li>
<li><p><strong>init_runs</strong> (<em>int</em>) – minimum number of AMIS runs for a new value of <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p></li>
<li><p><strong>significant_separation_sem_fold</strong> (<em>float</em>) – <a class="reference internal" href="#tracklib.analysis.bild.amis.FixedkSampler.t_stat" title="tracklib.analysis.bild.amis.FixedkSampler.t_stat"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">FixedkSampler.t_stat</span></code></a></p></li>
<li><p><strong>k_lookahead</strong> (<em>int</em>) – how far we look ahead for global maxima. As long as there is a current
candidate for global optimum at <code class="docutils literal notranslate"><span class="pre">k</span> <span class="pre">&gt;=</span> <span class="pre">k_max</span> <span class="pre">-</span> <span class="pre">k_lookahead</span></code> (where
<code class="docutils literal notranslate"><span class="pre">k_max</span></code> is the largest <code class="docutils literal notranslate"><span class="pre">k</span></code> sampled so far), sample larger <code class="docutils literal notranslate"><span class="pre">k</span></code>
instead of refining the ones we have. The default value of 2 comes from
the fact that for binary profiles the evidence follows an odd-even
pattern, so it is necessary to look ahead by 2 additional switches.</p></li>
<li><p><strong>k_max</strong> (<em>int</em>) – the maximum number of switches to sample to</p></li>
<li><p><strong>sampler_kw</strong> (<em>dict</em>) – further keyword arguments when setting up the <a class="reference internal" href="#tracklib.analysis.bild.amis.FixedkSampler" title="tracklib.analysis.bild.amis.FixedkSampler"><code class="xref any py py-class docutils literal notranslate"><span class="pre">amis.FixedkSampler</span></code></a>
instances for each <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p></li>
<li><p><strong>show_progress</strong> (<em>bool</em>) – whether to show a progress bar</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><em>dict</em> –</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'samplers'</span></code> is a list of the <code class="docutils literal notranslate"><span class="pre">amis.FixedkSampler</span></code> instances,
including the full samples</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'k_updates'</span></code> is a record of which sampler was stepped in order.
Can be useful for diagnostics / to look a bit under the hood what
happens when</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ks'</span></code> is <code class="docutils literal notranslate"><span class="pre">np.array([sampler.k</span> <span class="pre">for</span> <span class="pre">sampler</span> <span class="pre">in</span> <span class="pre">samplers])</span></code>. For
convenience.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'evidence'</span></code> is an array with the final evidence values for each
<code class="docutils literal notranslate"><span class="pre">k</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'evidence_se'</span></code> are the associated standard errors</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'dE'</span></code> the evidence margin applied in finding the point estimate
(see next two points)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'best_k'</span></code> optimal number of switches identified using evidence
margin <code class="docutils literal notranslate"><span class="pre">dE</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'profile'</span></code> point estimate with that optimal number of switches</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function takes a value for the evidence margin ΔE, such that we can
immediately give a point estimate. However, one should always make sure to
study the behavior of the results under changing ΔE. To that end, you can
always find the <code class="docutils literal notranslate"><span class="pre">best_k</span></code> and <code class="docutils literal notranslate"><span class="pre">profile</span></code> from the list of samplers by a
construction like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">sample</span><span class="p">(</span><span class="o">...</span><span class="p">)</span> <span class="c1"># run sampling</span>
<span class="gp">... </span><span class="n">dE</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1"># set dE</span>
<span class="gp">... </span><span class="c1"># Find associated profile</span>
<span class="gp">... </span><span class="n">ks_plausible</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="s1">&#39;ks&#39;</span><span class="p">][</span><span class="n">out</span><span class="p">[</span><span class="s1">&#39;evidence&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s1">&#39;evidence&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="n">dE</span><span class="p">]</span>
<span class="gp">... </span><span class="n">best_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">ks_plausible</span><span class="p">)</span>
<span class="gp">... </span><span class="n">profile</span> <span class="o">=</span> <span class="n">samplers</span><span class="p">[</span><span class="n">out</span><span class="p">[</span><span class="s1">&#39;best_k&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">MLE_profile</span><span class="p">()</span>
</pre></div>
</div>
<p>Post-processing functionality is provided in the <a class="reference internal" href="#module-tracklib.analysis.bild.postproc" title="tracklib.analysis.bild.postproc"><code class="xref any py py-mod docutils literal notranslate"><span class="pre">postproc</span></code></a> module, but
usually the profile found by sampling alone is already pretty good.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">amis.FixedkSampler()</span></code>, <code class="xref py py-func docutils literal notranslate"><span class="pre">postproc()</span></code></p>
</div>
</dd></dl>

<dl class="class">
<dt id="tracklib.analysis.bild.core.SamplingResults">
<em class="property">class </em><code class="sig-prename descclassname">tracklib.analysis.bild.core.</code><code class="sig-name descname">SamplingResults</code><span class="sig-paren">(</span><em class="sig-param">traj</em>, <em class="sig-param">model</em>, <em class="sig-param">samplers</em>, <em class="sig-param">k_updates=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.core.SamplingResults" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Standard format for <a class="reference internal" href="#tracklib.analysis.bild.core.sample" title="tracklib.analysis.bild.core.sample"><code class="xref any py py-func docutils literal notranslate"><span class="pre">sample</span></code></a> output</p>
<dl class="attribute">
<dt id="tracklib.analysis.bild.core.SamplingResults.traj">
<code class="sig-name descname">traj</code><a class="headerlink" href="#tracklib.analysis.bild.core.SamplingResults.traj" title="Permalink to this definition">¶</a></dt>
<dd><p>the trajectory these results pertain to</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory">Trajectory</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tracklib.analysis.bild.core.SamplingResults.model">
<code class="sig-name descname">model</code><a class="headerlink" href="#tracklib.analysis.bild.core.SamplingResults.model" title="Permalink to this definition">¶</a></dt>
<dd><p>the model used in obtaining them</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel" title="tracklib.analysis.bild.models.MultiStateModel">MultiStateModel</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tracklib.analysis.bild.core.SamplingResults.samplers">
<code class="sig-name descname">samplers</code><a class="headerlink" href="#tracklib.analysis.bild.core.SamplingResults.samplers" title="Permalink to this definition">¶</a></dt>
<dd><p>the samplers run for this inference run</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of FixedkSampler</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tracklib.analysis.bild.core.SamplingResults.k_updates">
<code class="sig-name descname">k_updates</code><a class="headerlink" href="#tracklib.analysis.bild.core.SamplingResults.k_updates" title="Permalink to this definition">¶</a></dt>
<dd><p>an array containing the order in which the samplers were updated</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tracklib.analysis.bild.core.SamplingResults.k">
<code class="sig-name descname">k</code><a class="headerlink" href="#tracklib.analysis.bild.core.SamplingResults.k" title="Permalink to this definition">¶</a></dt>
<dd><p>list of evaluated <code class="docutils literal notranslate"><span class="pre">k</span></code> values</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tracklib.analysis.bild.core.SamplingResults.evidence">
<code class="sig-name descname">evidence</code><a class="headerlink" href="#tracklib.analysis.bild.core.SamplingResults.evidence" title="Permalink to this definition">¶</a></dt>
<dd><p>the corresponding evidences for each <code class="docutils literal notranslate"><span class="pre">k</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tracklib.analysis.bild.core.SamplingResults.evidence_se">
<code class="sig-name descname">evidence_se</code><a class="headerlink" href="#tracklib.analysis.bild.core.SamplingResults.evidence_se" title="Permalink to this definition">¶</a></dt>
<dd><p>the standard error on the evidence</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<em class="property">property </em><code class="sig-name descname">k</code></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<em class="property">property </em><code class="sig-name descname">evidence</code></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<em class="property">property </em><code class="sig-name descname">evidence_se</code></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.core.SamplingResults.best_profile">
<code class="sig-name descname">best_profile</code><span class="sig-paren">(</span><em class="sig-param">dE=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.core.SamplingResults.best_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the best profile at given ΔE</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dE</strong> (<em>float &gt;= 0</em>) – the evidence margin to apply</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Loopingprofile</em></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-tracklib.analysis.bild.models">
<span id="tracklib-analysis-bild-models"></span><h2><a class="toc-backref" href="#id3">tracklib.analysis.bild.models</a><a class="headerlink" href="#module-tracklib.analysis.bild.models" title="Permalink to this headline">¶</a></h2>
<p>Inference models and the interface they should conform to</p>
<p>The <a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel" title="tracklib.analysis.bild.models.MultiStateModel"><code class="xref any py py-class docutils literal notranslate"><span class="pre">MultiStateModel</span></code></a> defines the interface used for inference by the rest of
the BILD module. We provide specific implementations, the <a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateRouse" title="tracklib.analysis.bild.models.MultiStateRouse"><code class="xref any py py-class docutils literal notranslate"><span class="pre">MultiStateRouse</span></code></a>
model, as well as the <a class="reference internal" href="#tracklib.analysis.bild.models.FactorizedModel" title="tracklib.analysis.bild.models.FactorizedModel"><code class="xref any py py-class docutils literal notranslate"><span class="pre">FactorizedModel</span></code></a>, which essentially constitutes an HMM.</p>
<dl class="class">
<dt id="tracklib.analysis.bild.models.MultiStateModel">
<em class="property">class </em><code class="sig-prename descclassname">tracklib.analysis.bild.models.</code><code class="sig-name descname">MultiStateModel</code><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Abstract base class for inference models</p>
<p>The most important capability of any model is the likelihood function
<a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel.logL" title="tracklib.analysis.bild.models.MultiStateModel.logL"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">logL</span></code></a> for a combination of <a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loopingprofile</span></code></a> and <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>. Furthermore,
a model should be able to tell how many states it has and what number of
spatial dimensions it expects through the <a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel.nStates" title="tracklib.analysis.bild.models.MultiStateModel.nStates"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">nStates</span></code></a> and <a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel.d" title="tracklib.analysis.bild.models.MultiStateModel.d"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">d</span></code></a> properties
respectively.</p>
<p>Finally, there are some convenience functions that are recommended, but not
required to implement:</p>
<blockquote>
<div><ul class="simple">
<li><p>provide an initial guess for a good profile by <a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel.initial_loopingprofile" title="tracklib.analysis.bild.models.MultiStateModel.initial_loopingprofile"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">initial_loopingprofile</span></code></a></p></li>
<li><p>sample from the likelihood by <a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel.trajectory_from_loopingprofile" title="tracklib.analysis.bild.models.MultiStateModel.trajectory_from_loopingprofile"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">trajectory_from_loopingprofile</span></code></a></p></li>
</ul>
</div></blockquote>
<dl class="method">
<dt id="tracklib.analysis.bild.models.MultiStateModel.nStates">
<em class="property">property </em><code class="sig-name descname">nStates</code><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateModel.nStates" title="Permalink to this definition">¶</a></dt>
<dd><p>How many internal states does this model have?</p>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.MultiStateModel.d">
<em class="property">property </em><code class="sig-name descname">d</code><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateModel.d" title="Permalink to this definition">¶</a></dt>
<dd><p>Spatial dimension</p>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.MultiStateModel.initial_loopingprofile">
<code class="sig-name descname">initial_loopingprofile</code><span class="sig-paren">(</span><em class="sig-param">traj</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateModel.initial_loopingprofile" title="Permalink to this definition">¶</a></dt>
<dd><p>Give a quick guess for a good <a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loopingprofile</span></code></a> for a <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>.</p>
<p>The default implementation gives a random <a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loopingprofile</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>traj</strong> (<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><em>Trajectory</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Loopingprofile</em></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.MultiStateModel.logL">
<em class="property">abstract </em><code class="sig-name descname">logL</code><span class="sig-paren">(</span><em class="sig-param">loopingprofile</em>, <em class="sig-param">traj</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateModel.logL" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate log-likelihood for (<a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loopingprofile</span></code></a>, <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>) pair.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loopingprofile</strong> (<a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><em>Loopingprofile</em></a>) – </p></li>
<li><p><strong>traj</strong> (<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><em>Trajectory</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float</em> – log-likelihood associated with the inputs</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.MultiStateModel.trajectory_from_loopingprofile">
<code class="sig-name descname">trajectory_from_loopingprofile</code><span class="sig-paren">(</span><em class="sig-param">profile</em>, <em class="sig-param">localization_error=None</em>, <em class="sig-param">missing_frames=None</em>, <em class="sig-param">preproc=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateModel.trajectory_from_loopingprofile" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a> for the given <a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loopingprofile</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>profile</strong> (<a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><em>Loopingprofile</em></a>) – </p></li>
<li><p><strong>localization_error</strong> (<em>float</em><em> or </em><em>(</em><em>d</em><em>,</em><em>) </em><em>np.ndarray</em><em>, </em><em>dtype=float</em>) – how much Gaussian noise to add to the trajectory. Specify either as
a single float, in which case a Gaussian random variable of that
standard deviation will be added to each dimension, or as an array
with one value of the standard deviation for each dimension
individually.</p></li>
<li><p><strong>missing_frames</strong> (<em>None</em><em>, </em><em>float in</em><em> [</em><em>0</em><em>, </em><em>1</em><em>)</em><em>, </em><em>int</em><em>, or </em><em>np.ndarray</em>) – <dl class="simple">
<dt>frames to remove from the generated trajectory. Can be</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> or <code class="docutils literal notranslate"><span class="pre">0</span></code> : remove no frames</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">float</span> <span class="pre">in</span> <span class="pre">(0,</span> <span class="pre">1)</span></code> : remove frames at random, with this
probability</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int</span></code> : remove this many frames at random</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">np.ndarray,</span> <span class="pre">dtype=int</span></code> : indices of the frames to remove</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>preproc</strong> (<em>string</em>) – specific to this base implementation. Set to
<code class="docutils literal notranslate"><span class="pre">'localization_error'</span></code> or <code class="docutils literal notranslate"><span class="pre">'missing_frames'</span></code> to resolve the
corresponding parameter according to the rules outlined above and
return it.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Trajectory</em></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Even though this method provides default preprocessing for
<code class="docutils literal notranslate"><span class="pre">localization_error</span></code> and <code class="docutils literal notranslate"><span class="pre">missing_frames</span></code>, implementations are not
forced to use them. So the meaning of these arguments might be
different from what’s outlined here.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tracklib.analysis.bild.models.MultiStateRouse">
<em class="property">class </em><code class="sig-prename descclassname">tracklib.analysis.bild.models.</code><code class="sig-name descname">MultiStateRouse</code><span class="sig-paren">(</span><em class="sig-param">N</em>, <em class="sig-param">D</em>, <em class="sig-param">k</em>, <em class="sig-param">d=3</em>, <em class="sig-param">looppositions=(None</em>, <em class="sig-param">(0</em>, <em class="sig-param">-1))</em>, <em class="sig-param">measurement='end2end'</em>, <em class="sig-param">localization_error=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateRouse" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel" title="tracklib.analysis.bild.models.MultiStateModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">tracklib.analysis.bild.models.MultiStateModel</span></code></a></p>
<p>A multi-state Rouse model</p>
<p>This inference model uses a given number of <a class="reference internal" href="tracklib.models.html#tracklib.models.rouse.Model" title="tracklib.models.rouse.Model"><code class="xref any py py-class docutils literal notranslate"><span class="pre">rouse.Model</span></code></a> instances to
choose from for each propagation interval. In the default use case this
switches between a looped and unlooped model, but it could be way more
general than that, e.g. incorporating different looped states, loop
positions, numbers of loops, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N</strong> (<em>int</em>) – number of monomers</p></li>
<li><p><strong>k</strong> (<em>D</em><em>,</em>) – Rouse parameters: 1d diffusion constant of free monomers and backbone
spring constant</p></li>
<li><p><strong>d</strong> (<em>int</em><em>, </em><em>optional</em>) – spatial dimension</p></li>
<li><p><strong>looppositions</strong> (<em>list of tuples</em>) – specification of the extra bonds to add for the different states.  Each
entry corresponds to one possible state of the model and should be a
tuple <code class="docutils literal notranslate"><span class="pre">(left_mon,</span> <span class="pre">right_mon,</span> <span class="pre">rel_strength=1)</span></code> or a list of such;
specification of <code class="docutils literal notranslate"><span class="pre">rel_strength</span></code> is optional. This will introduce an
additional bond between the monomer indexed <code class="docutils literal notranslate"><span class="pre">left_mon</span></code> and the one
indexed <code class="docutils literal notranslate"><span class="pre">right_mon</span></code>, with strength <code class="docutils literal notranslate"><span class="pre">rel_strength*k</span></code>. Note that you
can remove the i-th backbone bond by giving <code class="docutils literal notranslate"><span class="pre">(i,</span> <span class="pre">i+1,</span> <span class="pre">-1)</span></code>. Remember
that (if relevant) you also have to include the unlooped state, which
you can do by giving <code class="docutils literal notranslate"><span class="pre">None</span></code> instead of a tuple; alternatively, give a
vacuous extra bond like <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">0)</span></code>.</p></li>
<li><p><strong>measurement</strong> (<em>&quot;end2end&quot;</em><em> or </em><em>(</em><em>N</em><em>,</em><em>) </em><em>np.ndarray</em>) – which distance to measure. The default setting “end2end” is equivalent
to specifying a vector <code class="docutils literal notranslate"><span class="pre">np.array([-1,</span> <span class="pre">0,</span> <span class="pre">...,</span> <span class="pre">0,</span> <span class="pre">1])</span></code>, i.e. measuring
the distance from the first to the last monomer.</p></li>
<li><p><strong>localization_error</strong> (<em>float</em><em>, </em><em>(</em><em>d</em><em>,</em><em>) </em><em>np.array</em><em>, or </em><em>None</em><em>, </em><em>optional</em>) – localization error assumed by the model, e.g. in calculating the
likelihood or generating trajectories. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, try to use
<code class="docutils literal notranslate"><span class="pre">traj.meta['localization_error']</span></code> where possible. If scalar, will be
broadcast to all spatial dimensions.</p></li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt id="tracklib.analysis.bild.models.MultiStateRouse.models">
<code class="sig-name descname">models</code><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateRouse.models" title="Permalink to this definition">¶</a></dt>
<dd><p>the Rouse models for the individual states</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of <a class="reference internal" href="tracklib.models.html#tracklib.models.rouse.Model" title="tracklib.models.rouse.Model"><code class="xref any py py-class docutils literal notranslate"><span class="pre">rouse.Model</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tracklib.analysis.bild.models.MultiStateRouse.measurement">
<code class="sig-name descname">measurement</code><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateRouse.measurement" title="Permalink to this definition">¶</a></dt>
<dd><p>the measurement vector</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>(N,) np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tracklib.analysis.bild.models.MultiStateRouse.localization_error">
<code class="sig-name descname">localization_error</code><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateRouse.localization_error" title="Permalink to this definition">¶</a></dt>
<dd><p>if <code class="docutils literal notranslate"><span class="pre">None</span></code>, use <code class="docutils literal notranslate"><span class="pre">traj.meta['localization_error']</span></code> where possible</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array or None</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Notes</p>
<p>This class also provides a function to convert to a <a class="reference internal" href="#tracklib.analysis.bild.models.FactorizedModel" title="tracklib.analysis.bild.models.FactorizedModel"><code class="xref any py py-class docutils literal notranslate"><span class="pre">FactorizedModel</span></code></a>,
using the exact steady state distributions of the Rouse models. This is
used for example to quickly guess an initial looping profile.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel" title="tracklib.analysis.bild.models.MultiStateModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiStateModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">rouse.Model</span></code></p>
</div>
<dl class="method">
<dt id="tracklib.analysis.bild.models.MultiStateRouse.nStates">
<em class="property">property </em><code class="sig-name descname">nStates</code><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateRouse.nStates" title="Permalink to this definition">¶</a></dt>
<dd><p>How many internal states does this model have?</p>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.MultiStateRouse.d">
<em class="property">property </em><code class="sig-name descname">d</code><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateRouse.d" title="Permalink to this definition">¶</a></dt>
<dd><p>Spatial dimension</p>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.MultiStateRouse.initial_loopingprofile">
<code class="sig-name descname">initial_loopingprofile</code><span class="sig-paren">(</span><em class="sig-param">traj</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateRouse.initial_loopingprofile" title="Permalink to this definition">¶</a></dt>
<dd><p>Give an initial guess for a looping profile</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>traj</strong> (<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><em>Trajectory</em></a>) – the trajectory under investigation</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Loopingprofile</em></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.MultiStateRouse.logL">
<code class="sig-name descname">logL</code><span class="sig-paren">(</span><em class="sig-param">profile</em>, <em class="sig-param">traj</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateRouse.logL" title="Permalink to this definition">¶</a></dt>
<dd><p>Rouse likelihood, evaluated by Kalman filter</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>profile</strong> (<a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><em>Loopingprofile</em></a>) – </p></li>
<li><p><strong>traj</strong> (<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><em>Trajectory</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float</em></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.MultiStateRouse.trajectory_from_loopingprofile">
<code class="sig-name descname">trajectory_from_loopingprofile</code><span class="sig-paren">(</span><em class="sig-param">profile</em>, <em class="sig-param">localization_error=None</em>, <em class="sig-param">missing_frames=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateRouse.trajectory_from_loopingprofile" title="Permalink to this definition">¶</a></dt>
<dd><p>Generative model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>profile</strong> (<a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><em>Loopingprofile</em></a>) – the profile from whose associated ensemble to sample</p></li>
<li><p><strong>localization_error</strong> (<em>float</em><em> or </em><em>(</em><em>d</em><em>,</em><em>) </em><em>np.ndarray</em><em>, </em><em>dtype=float</em>) – see <a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel.trajectory_from_loopingprofile" title="tracklib.analysis.bild.models.MultiStateModel.trajectory_from_loopingprofile"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">MultiStateModel.trajectory_from_loopingprofile</span></code></a></p></li>
<li><p><strong>missing_frames</strong> (<em>None</em><em>, </em><em>float in</em><em> [</em><em>0</em><em>, </em><em>1</em><em>)</em><em>, </em><em>int</em><em>, or </em><em>np.ndarray</em>) – see <a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel.trajectory_from_loopingprofile" title="tracklib.analysis.bild.models.MultiStateModel.trajectory_from_loopingprofile"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">MultiStateModel.trajectory_from_loopingprofile</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Trajectory</em></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.MultiStateRouse.toFactorized">
<code class="sig-name descname">toFactorized</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.models.MultiStateRouse.toFactorized" title="Permalink to this definition">¶</a></dt>
<dd><p>Give the corresponding <a class="reference internal" href="#tracklib.analysis.bild.models.FactorizedModel" title="tracklib.analysis.bild.models.FactorizedModel"><code class="xref any py py-class docutils literal notranslate"><span class="pre">FactorizedModel</span></code></a></p>
<p>This is the model that simply calculates likelihoods from the steady
state probabilities of each of the individual states.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>FactorizedModel</em></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tracklib.analysis.bild.models.FactorizedModel">
<em class="property">class </em><code class="sig-prename descclassname">tracklib.analysis.bild.models.</code><code class="sig-name descname">FactorizedModel</code><span class="sig-paren">(</span><em class="sig-param">distributions</em>, <em class="sig-param">d=3</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.models.FactorizedModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel" title="tracklib.analysis.bild.models.MultiStateModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">tracklib.analysis.bild.models.MultiStateModel</span></code></a></p>
<p>A simplified model, assuming time scale separation</p>
<p>This model assumes that each point is sampled from one of a given list of
distributions, where there is no correlation between the choice of
distribution for each point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>distributions</strong> (<em>list of distribution objects</em>) – these will usually be <code class="docutils literal notranslate"><span class="pre">scipy.stats.rv_continuous</span></code> objects (e.g.
Maxwell), but can be pretty arbitrary. The only function they have to
provide is <code class="docutils literal notranslate"><span class="pre">logpdf()</span></code>, which should take a scalar or vector of
distance values and return a corresponding number of outputs. If you
plan on using <a class="reference internal" href="#tracklib.analysis.bild.models.FactorizedModel.trajectory_from_loopingprofile" title="tracklib.analysis.bild.models.FactorizedModel.trajectory_from_loopingprofile"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">trajectory_from_loopingprofile</span></code></a>, the distributions
should also have an <code class="docutils literal notranslate"><span class="pre">rvs()</span></code> method for sampling.</p>
</dd>
</dl>
<dl class="attribute">
<dt id="tracklib.analysis.bild.models.FactorizedModel.distributions">
<code class="sig-name descname">distributions</code><a class="headerlink" href="#tracklib.analysis.bild.models.FactorizedModel.distributions" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of distribution objects</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Notes</p>
<p>This being a heuristical model, we assume that the localization error is
already incorporated in the <code class="xref any docutils literal notranslate"><span class="pre">distributions</span></code>, as would be the case if they
came from experimental data. Therefore, this class ignores the
<code class="docutils literal notranslate"><span class="pre">meta['localization_error']</span></code> field of <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">d</span></code> attribute mandated by the <a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateRouse" title="tracklib.analysis.bild.models.MultiStateRouse"><code class="xref any py py-class docutils literal notranslate"><span class="pre">MultiStateRouse</span></code></a> interface is used
only for generation of trajectories.</p>
<p>Instances of this class memoize trajectories they have seen before. To
reset the memoization, you can either reinstantiate, or clear the cache
manually:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">FactorizedModel</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">distributions</span><span class="p">)</span>
<span class="gp">... </span><span class="n">model</span><span class="o">.</span><span class="n">clear_memo</span><span class="p">()</span>
</pre></div>
</div>
<p>If using <code class="docutils literal notranslate"><span class="pre">scipy.stats.maxwell</span></code>, make sure to use it correctly, i.e. you
have to specify <code class="docutils literal notranslate"><span class="pre">scale=...</span></code>. Writing <code class="docutils literal notranslate"><span class="pre">scipy.stats.maxwell(5)</span></code> instead
of <code class="docutils literal notranslate"><span class="pre">scipy.stats.maxwell(scale=5)</span></code> shifts the distribution instead of
scaling it and leads to <code class="docutils literal notranslate"><span class="pre">-inf</span></code> values in the likelihood.</p>
<p class="rubric">Examples</p>
<p>Experimentally measured distributions can be used straightforwardly using
<code class="docutils literal notranslate"><span class="pre">scipy.stats.gaussian_kde</span></code>: assuming we have measured ensembles of
distances <code class="docutils literal notranslate"><span class="pre">dists_i</span></code> for reference states <code class="docutils literal notranslate"><span class="pre">i</span></code>, we can use</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">FactorizedModel</span><span class="p">([</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">gaussian_kde</span><span class="p">(</span><span class="n">dists_0</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">gaussian_kde</span><span class="p">(</span><span class="n">dists_1</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">gaussian_kde</span><span class="p">(</span><span class="n">dists_2</span><span class="p">)])</span>
</pre></div>
</div>
<dl class="method">
<dt id="tracklib.analysis.bild.models.FactorizedModel.nStates">
<em class="property">property </em><code class="sig-name descname">nStates</code><a class="headerlink" href="#tracklib.analysis.bild.models.FactorizedModel.nStates" title="Permalink to this definition">¶</a></dt>
<dd><p>How many internal states does this model have?</p>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.FactorizedModel.d">
<em class="property">property </em><code class="sig-name descname">d</code><a class="headerlink" href="#tracklib.analysis.bild.models.FactorizedModel.d" title="Permalink to this definition">¶</a></dt>
<dd><p>Spatial dimension</p>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.FactorizedModel.clear_memo">
<code class="sig-name descname">clear_memo</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.models.FactorizedModel.clear_memo" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear the memoization cache</p>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.FactorizedModel.initial_loopingprofile">
<code class="sig-name descname">initial_loopingprofile</code><span class="sig-paren">(</span><em class="sig-param">traj</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.models.FactorizedModel.initial_loopingprofile" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the MLE profile for the given trajectory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>traj</strong> (<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><em>Trajectory</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Loopingprofile</em></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.FactorizedModel.logL">
<code class="sig-name descname">logL</code><span class="sig-paren">(</span><em class="sig-param">profile</em>, <em class="sig-param">traj</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.models.FactorizedModel.logL" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate log-likelihood for (<a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loopingprofile</span></code></a>, <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>) pair.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loopingprofile</strong> (<a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><em>Loopingprofile</em></a>) – </p></li>
<li><p><strong>traj</strong> (<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><em>Trajectory</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float</em> – log-likelihood associated with the inputs</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.models.FactorizedModel.trajectory_from_loopingprofile">
<code class="sig-name descname">trajectory_from_loopingprofile</code><span class="sig-paren">(</span><em class="sig-param">profile</em>, <em class="sig-param">localization_error=0.0</em>, <em class="sig-param">missing_frames=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.models.FactorizedModel.trajectory_from_loopingprofile" title="Permalink to this definition">¶</a></dt>
<dd><p>Generative model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>profile</strong> (<a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><em>Loopingprofile</em></a>) – the profile from whose associated ensemble to sample</p></li>
<li><p><strong>localization_error</strong> (<em>float</em><em> or </em><em>(</em><em>d</em><em>,</em><em>) </em><em>np.ndarray</em><em>, </em><em>dtype=float</em>) – see <a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel.trajectory_from_loopingprofile" title="tracklib.analysis.bild.models.MultiStateModel.trajectory_from_loopingprofile"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">MultiStateModel.trajectory_from_loopingprofile</span></code></a>; note that
since the localization error should already be accounted for in the
<a class="reference internal" href="#tracklib.analysis.bild.models.FactorizedModel.distributions" title="tracklib.analysis.bild.models.FactorizedModel.distributions"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">distributions</span></code></a> of the model, it is <em>not</em> added to the trajectory
here. Instead, it is just written to
<code class="docutils literal notranslate"><span class="pre">traj.meta['localization_error']</span></code>.</p></li>
<li><p><strong>missing_frames</strong> (<em>None</em><em>, </em><em>float in</em><em> [</em><em>0</em><em>, </em><em>1</em><em>)</em><em>, </em><em>int</em><em>, or </em><em>np.ndarray</em>) – see <a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel.trajectory_from_loopingprofile" title="tracklib.analysis.bild.models.MultiStateModel.trajectory_from_loopingprofile"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">MultiStateModel.trajectory_from_loopingprofile</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Trajectory</em></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The <a class="reference internal" href="#tracklib.analysis.bild.models.FactorizedModel" title="tracklib.analysis.bild.models.FactorizedModel"><code class="xref any py py-class docutils literal notranslate"><span class="pre">FactorizedModel</span></code></a> only contains distributions for the scalar
distance between the points, amounting to the assumption that the full
distribution of distance vectors is isotropic. Thus, in generating the
trajectory we sample a magnitude from the given distributions and a
direction from the unit sphere.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-tracklib.analysis.bild.postproc">
<span id="tracklib-analysis-bild-postproc"></span><h2><a class="toc-backref" href="#id4">tracklib.analysis.bild.postproc</a><a class="headerlink" href="#module-tracklib.analysis.bild.postproc" title="Permalink to this headline">¶</a></h2>
<p>Some post-processing of inferred profiles</p>
<p>This module provides an iterative optimization scheme for inferred looping
profiles. Briefly, at each step we evaluate how much the likelihood increases
if we were to move each boundary of the profile and then do the move that gives
the largest increase.</p>
<dl class="function">
<dt id="tracklib.analysis.bild.postproc.logLR_boundaries">
<code class="sig-prename descclassname">tracklib.analysis.bild.postproc.</code><code class="sig-name descname">logLR_boundaries</code><span class="sig-paren">(</span><em class="sig-param">profile</em>, <em class="sig-param">traj</em>, <em class="sig-param">model</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.postproc.logLR_boundaries" title="Permalink to this definition">¶</a></dt>
<dd><p>Give log-likelihood ratios for moving each boundary either direction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>profile</strong> (<a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><em>Loopingprofile</em></a>) – the profile whose boundaries we want to optimize</p></li>
<li><p><strong>traj</strong> (<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><em>Trajectory</em></a>) – the trajectory to which the profile applies</p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel" title="tracklib.analysis.bild.models.MultiStateModel"><em>MultiStateModel</em></a>) – the model providing the likelihood function</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>(k, 2) np.ndarray, dtype=float</em> – the log(likelihood ratio) for moving any of the <code class="docutils literal notranslate"><span class="pre">k</span></code> boundaries to the
left (<code class="docutils literal notranslate"><span class="pre">[i,</span> <span class="pre">0]</span></code>) / right (<code class="docutils literal notranslate"><span class="pre">[i,</span> <span class="pre">1]</span></code>).</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#tracklib.analysis.bild.postproc.optimize_boundary" title="tracklib.analysis.bild.postproc.optimize_boundary"><code class="xref py py-func docutils literal notranslate"><span class="pre">optimize_boundary()</span></code></a></p>
</div>
</dd></dl>

<dl class="exception">
<dt id="tracklib.analysis.bild.postproc.BoundaryEliminationError">
<em class="property">exception </em><code class="sig-prename descclassname">tracklib.analysis.bild.postproc.</code><code class="sig-name descname">BoundaryEliminationError</code><a class="headerlink" href="#tracklib.analysis.bild.postproc.BoundaryEliminationError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.bild.postproc.optimize_boundary">
<code class="sig-prename descclassname">tracklib.analysis.bild.postproc.</code><code class="sig-name descname">optimize_boundary</code><span class="sig-paren">(</span><em class="sig-param">profile</em>, <em class="sig-param">traj</em>, <em class="sig-param">model</em>, <em class="sig-param">max_iteration=10000</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.postproc.optimize_boundary" title="Permalink to this definition">¶</a></dt>
<dd><p>Locally optimize the boundaries of a profile</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>profile</strong> (<a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><em>Loopingprofile</em></a>) – the profile whose boundaries we want to optimize</p></li>
<li><p><strong>traj</strong> (<a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><em>Trajectory</em></a>) – the trajectory to which the profile applies</p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="#tracklib.analysis.bild.models.MultiStateModel" title="tracklib.analysis.bild.models.MultiStateModel"><em>MultiStateModel</em></a>) – the model providing the likelihood function</p></li>
<li><p><strong>max_iteration</strong> (<em>int</em><em>, </em><em>optional</em>) – limit on the number of iterations through the (find boundaries) –&gt;
(make best move) cycle</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#tracklib.analysis.bild.postproc.BoundaryEliminationError" title="tracklib.analysis.bild.postproc.BoundaryEliminationError"><strong>BoundaryEliminationError</strong></a> – if the local optimization tries to shrink an interval to zero, such
    that the total number of boundaries would change. This usually suggests
    that the original sampling might not have been extensive enough.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>Loopingprofile</em> – the optimized profile</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-tracklib.analysis.bild.util">
<span id="tracklib-analysis-bild-util"></span><h2><a class="toc-backref" href="#id5">tracklib.analysis.bild.util</a><a class="headerlink" href="#module-tracklib.analysis.bild.util" title="Permalink to this headline">¶</a></h2>
<p>Utilities for BILD</p>
<dl class="class">
<dt id="tracklib.analysis.bild.util.Loopingprofile">
<em class="property">class </em><code class="sig-prename descclassname">tracklib.analysis.bild.util.</code><code class="sig-name descname">Loopingprofile</code><span class="sig-paren">(</span><em class="sig-param">states=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.util.Loopingprofile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class represents a single looping profile</p>
<p>This is a thin wrapper around a <code class="xref any docutils literal notranslate"><span class="pre">state</span></code> array, whose entries indicate
which state of the model should be used for propagation from frame to
frame. Specifically, the following scheme applies to the relation between a
<a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loopingprofile</span></code></a> <code class="docutils literal notranslate"><span class="pre">profile</span></code> and the associated <a class="reference internal" href="tracklib.html#tracklib.trajectory.Trajectory" title="tracklib.trajectory.Trajectory"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a> <code class="docutils literal notranslate"><span class="pre">traj</span></code>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>profile[0]              profile[1]                                  profile[-1]
-------------&gt; traj[0] ------------&gt; traj[1] --- ... ---&gt; traj[-2] -------------&gt; traj[-1]
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">profile[i]</span></code> can be interpreted as “the state of the model used
to propagate to <code class="docutils literal notranslate"><span class="pre">traj[i]</span></code>”. Furthermore, <code class="docutils literal notranslate"><span class="pre">profile[0]</span></code> indicates the
model state used to calculate the steady state ensemble each trajectory
starts from.</p>
<dl class="simple">
<dt>Operators defined for a <a class="reference internal" href="#tracklib.analysis.bild.util.Loopingprofile" title="tracklib.analysis.bild.util.Loopingprofile"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loopingprofile</span></code></a> <code class="docutils literal notranslate"><span class="pre">profile</span></code>:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">len(profile)</span></code> gives the length in frames</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">profile[i]</span></code> for element-access (get/set)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">profile0</span> <span class="pre">==</span> <span class="pre">profile1</span></code> if the associated states are equal</p></li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt id="tracklib.analysis.bild.util.Loopingprofile.states">
<code class="sig-name descname">states</code><a class="headerlink" href="#tracklib.analysis.bild.util.Loopingprofile.states" title="Permalink to this definition">¶</a></dt>
<dd><p>the internal state array. If this is not given upon initialization,
initialized to an empty array.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray, dtype=int</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.util.Loopingprofile.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.util.Loopingprofile.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy to a new object</p>
<p>Because we can copy just <code class="docutils literal notranslate"><span class="pre">self.state</span></code>, this is faster than doing
<code class="docutils literal notranslate"><span class="pre">deepcopy(profile)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>Loopingprofile</em></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.util.Loopingprofile.count_switches">
<code class="sig-name descname">count_switches</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.util.Loopingprofile.count_switches" title="Permalink to this definition">¶</a></dt>
<dd><p>Give number of switches in the profile</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>int</em></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.util.Loopingprofile.intervals">
<code class="sig-name descname">intervals</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.util.Loopingprofile.intervals" title="Permalink to this definition">¶</a></dt>
<dd><p>Find intervals of constant state in the profile</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>list of tuples</em> – each entry signifies an interval, in the format <code class="docutils literal notranslate"><span class="pre">(start,</span> <span class="pre">end,</span>
<span class="pre">state)</span></code>, where <code class="docutils literal notranslate"><span class="pre">start</span></code> or <code class="docutils literal notranslate"><span class="pre">end</span></code> are <code class="docutils literal notranslate"><span class="pre">None</span></code> for the
first/last interval in the profile, respectively.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tracklib.analysis.bild.util.Loopingprofile.plottable">
<code class="sig-name descname">plottable</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.util.Loopingprofile.plottable" title="Permalink to this definition">¶</a></dt>
<dd><p>For plotting profiles</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>t, y</strong> (<em>np.ndarray</em>) – coordinates for plotting the profile as proper step function. See
below for usage</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Given a profile <code class="docutils literal notranslate"><span class="pre">profile</span></code>, you might visualize it as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="gp">... </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">profile</span><span class="o">.</span><span class="n">plottable</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:green&#39;</span><span class="p">)</span>
<span class="gp">... </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Note that another way to achieve the same thing is to just use
<code class="xref any docutils literal notranslate"><span class="pre">matplotlib</span></code>’s <code class="docutils literal notranslate"><span class="pre">stairs</span></code> function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">stairs</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">edges</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">profile</span><span class="p">)))</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="tracklib.analysis.bild.util.state_probabilities">
<code class="sig-prename descclassname">tracklib.analysis.bild.util.</code><code class="sig-name descname">state_probabilities</code><span class="sig-paren">(</span><em class="sig-param">profiles</em>, <em class="sig-param">nStates=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tracklib.analysis.bild.util.state_probabilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate marginal probabilities for an ensemble of profiles</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>profiles</strong> (<em>list of Loopingprofile</em>) – the profiles to use</p></li>
<li><p><strong>nStates</strong> (<em>int</em><em>, </em><em>optional</em>) – the number of states in the model associated with the profiles. Since a
profile might be (e.g.) flat zero, it is not in general possible to
determine this from the profiles. Does not affect the calculated
probabilities, but (“just”) the shape of the output. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, will
be identified from the profiles (i.e. <code class="docutils literal notranslate"><span class="pre">nStates</span> <span class="pre">=</span> <span class="pre">(largest</span> <span class="pre">state</span> <span class="pre">index</span>
<span class="pre">found)</span> <span class="pre">+</span> <span class="pre">1</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>(nStates, T) np.ndarray</em> – the marginal probabilities for each state at each time point</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">tracklib.analysis.bild</a><ul>
<li><a class="reference internal" href="#module-tracklib.analysis.bild.amis">tracklib.analysis.bild.amis</a></li>
<li><a class="reference internal" href="#module-tracklib.analysis.bild.core">tracklib.analysis.bild.core</a></li>
<li><a class="reference internal" href="#module-tracklib.analysis.bild.models">tracklib.analysis.bild.models</a></li>
<li><a class="reference internal" href="#module-tracklib.analysis.bild.postproc">tracklib.analysis.bild.postproc</a></li>
<li><a class="reference internal" href="#module-tracklib.analysis.bild.util">tracklib.analysis.bild.util</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="tracklib.analysis.html"
                        title="previous chapter">tracklib.analysis</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tracklib.analysis.msdfit.html"
                        title="next chapter">tracklib.analysis.msdfit</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tracklib.analysis.bild.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tracklib.analysis.msdfit.html" title="tracklib.analysis.msdfit"
             >next</a> |</li>
        <li class="right" >
          <a href="tracklib.analysis.html" title="tracklib.analysis"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">tracklib 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="tracklib.html" >tracklib</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="tracklib.analysis.html" >tracklib.analysis</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Simon Grosse-Holz.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.1.2.
    </div>
  </body>
</html>